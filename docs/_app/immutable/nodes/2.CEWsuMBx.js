import{s as ue,z as q,k as b,i as g,S as ke,w as de,e as C,t as T,b as y,d as E,f as S,h as O,j as M,q as D,l as A,m as P,T as X,C as _e,p as J,J as he,U as z,r as H,v as pe,y as me,x as R,V as we,W as Y}from"../chunks/scheduler.CDGtiUFo.js";import{S as ve,i as ge,t as L,g as Z,a as N,c as G,b as K,d as U,m as B,e as W,f as be}from"../chunks/index.B5cZ8GrW.js";import{b as Ce,e as F}from"../chunks/index.Dh9Un3aJ.js";import{b as Ee}from"../chunks/paths.B6yWBuGm.js";import{h as De,p as $,C as x,a as Ie,b as Ae}from"../chunks/misc.B53fYwtt.js";const Se=(r,e)=>{const s=De(e);if(e==="")return{readingCorrectness:Array.from({length:r.reading.length},()=>!1),answerCorrectness:Array.from({length:e.length},()=>!1),isCorrect:!1};const l=Ve(s,r),i=e.split("").map((o,d)=>o===l.expectedAnswer[d]),n=l.expectedAnswer.map((o,d)=>o===e[d]),t=Array.from({length:r.reading.length},()=>!0);l.readingMapping.map((o,d)=>{n[d]||(t[o]=!1)});const f=i.every(o=>o),u=t.every(o=>o),m=e.length===l.expectedAnswer.length;return{readingCorrectness:t,answerCorrectness:i,isCorrect:f&&u&&m}},Ve=(r,e)=>{const s=[],l=[];for(let i=0;i<e.reading.length;i++){const n=e.furigana[i],t=e.reading[i];r?(s.push(t),l.push(i)):(n===""?t:n).split("").forEach((u,m)=>{s.push(u),l.push(i)})}return{expectedAnswer:s,readingMapping:l}};function ee(r){let e,s=r[2].translation+"",l,i,n,t,f=r[2].hint+"",u,m,o,d,v,c,_,a,h=r[4]&&te(r),k=r[3]&&se(r);return{c(){e=C("h1"),l=T(s),i=y(),n=C("div"),t=C("p"),u=T(f),m=y(),o=C("div"),d=C("input"),v=y(),h&&h.c(),c=y(),k&&k.c(),_=q(),this.h()},l(p){e=E(p,"H1",{class:!0});var w=S(e);l=O(w,s),w.forEach(g),i=M(p),n=E(p,"DIV",{class:!0});var V=S(n);t=E(V,"P",{});var j=S(t);u=O(j,f),j.forEach(g),V.forEach(g),m=M(p),o=E(p,"DIV",{class:!0});var I=S(o);d=E(I,"INPUT",{type:!0,class:!0}),I.forEach(g),v=M(p),h&&h.l(p),c=M(p),k&&k.l(p),_=q(),this.h()},h(){D(e,"class","svelte-1k37uw4"),D(n,"class","hint-container svelte-1k37uw4"),D(d,"type","text"),D(d,"class","svelte-1k37uw4"),D(o,"class","input-container svelte-1k37uw4")},m(p,w){b(p,e,w),A(e,l),b(p,i,w),b(p,n,w),A(n,t),A(t,u),b(p,m,w),b(p,o,w),A(o,d),r[10](d),b(p,v,w),h&&h.m(p,w),b(p,c,w),k&&k.m(p,w),b(p,_,w),a=!0},p(p,w){(!a||w&4)&&s!==(s=p[2].translation+"")&&P(l,s),(!a||w&4)&&f!==(f=p[2].hint+"")&&P(u,f),p[4]?h?h.p(p,w):(h=te(p),h.c(),h.m(c.parentNode,c)):h&&(h.d(1),h=null),p[3]?k?(k.p(p,w),w&8&&L(k,1)):(k=se(p),k.c(),L(k,1),k.m(_.parentNode,_)):k&&(Z(),N(k,1,1,()=>{k=null}),G())},i(p){a||(L(k),a=!0)},o(p){N(k),a=!1},d(p){p&&(g(e),g(i),g(n),g(m),g(o),g(v),g(c),g(_)),r[10](null),h&&h.d(p),k&&k.d(p)}}}function te(r){let e,s;return{c(){e=C("div"),s=T(r[4]),this.h()},l(l){e=E(l,"DIV",{class:!0});var i=S(e);s=O(i,r[4]),i.forEach(g),this.h()},h(){D(e,"class","notification svelte-1k37uw4")},m(l,i){b(l,e,i),A(e,s)},p(l,i){i&16&&P(s,l[4])},d(l){l&&g(e)}}}function se(r){let e,s,l,i,n,t,f,u,m,o=r[5]?"Correct!":"Incorrect",d,v,c;s=new x({props:{readings:r[1],furigana:[],colors:r[7]}}),n=new x({props:{readings:r[2].reading,furigana:r[2].furigana,colors:r[6]}});let _=r[2].note&&le(r);return{c(){e=C("div"),K(s.$$.fragment),l=y(),i=C("div"),K(n.$$.fragment),t=y(),_&&_.c(),f=y(),u=C("div"),m=C("h2"),d=T(o),this.h()},l(a){e=E(a,"DIV",{class:!0});var h=S(e);U(s.$$.fragment,h),h.forEach(g),l=M(a),i=E(a,"DIV",{class:!0});var k=S(i);U(n.$$.fragment,k),k.forEach(g),t=M(a),_&&_.l(a),f=M(a),u=E(a,"DIV",{class:!0});var p=S(u);m=E(p,"H2",{class:!0});var w=S(m);d=O(w,o),w.forEach(g),p.forEach(g),this.h()},h(){D(e,"class","sentence-container svelte-1k37uw4"),D(i,"class","sentence-container svelte-1k37uw4"),D(m,"class",v=X(r[5]?"correct":"incorrect")+" svelte-1k37uw4"),D(u,"class","result-container svelte-1k37uw4")},m(a,h){b(a,e,h),B(s,e,null),b(a,l,h),b(a,i,h),B(n,i,null),b(a,t,h),_&&_.m(a,h),b(a,f,h),b(a,u,h),A(u,m),A(m,d),c=!0},p(a,h){const k={};h&2&&(k.readings=a[1]),h&128&&(k.colors=a[7]),s.$set(k);const p={};h&4&&(p.readings=a[2].reading),h&4&&(p.furigana=a[2].furigana),h&64&&(p.colors=a[6]),n.$set(p),a[2].note?_?_.p(a,h):(_=le(a),_.c(),_.m(f.parentNode,f)):_&&(_.d(1),_=null),(!c||h&32)&&o!==(o=a[5]?"Correct!":"Incorrect")&&P(d,o),(!c||h&32&&v!==(v=X(a[5]?"correct":"incorrect")+" svelte-1k37uw4"))&&D(m,"class",v)},i(a){c||(L(s.$$.fragment,a),L(n.$$.fragment,a),c=!0)},o(a){N(s.$$.fragment,a),N(n.$$.fragment,a),c=!1},d(a){a&&(g(e),g(l),g(i),g(t),g(f),g(u)),W(s),W(n),_&&_.d(a)}}}function le(r){let e,s,l=r[2].note+"",i;return{c(){e=C("div"),s=C("p"),i=T(l),this.h()},l(n){e=E(n,"DIV",{class:!0});var t=S(e);s=E(t,"P",{});var f=S(s);i=O(f,l),f.forEach(g),t.forEach(g),this.h()},h(){D(e,"class","note-container svelte-1k37uw4")},m(n,t){b(n,e,t),A(e,s),A(s,i)},p(n,t){t&4&&l!==(l=n[2].note+"")&&P(i,l)},d(n){n&&g(e)}}}function ye(r){let e,s,l=r[2]&&ee(r);return{c(){l&&l.c(),e=q()},l(i){l&&l.l(i),e=q()},m(i,n){l&&l.m(i,n),b(i,e,n),s=!0},p(i,[n]){i[2]?l?(l.p(i,n),n&4&&L(l,1)):(l=ee(i),l.c(),L(l,1),l.m(e.parentNode,e)):l&&(Z(),N(l,1,1,()=>{l=null}),G())},i(i){s||(L(l),s=!0)},o(i){N(l),s=!1},d(i){i&&g(e),l&&l.d(i)}}}function Me(r,e,s){let l,i,n,t,f,{selectedDeck:u=null}=e;const m=ke();let o,d="",v=!1,c=!1,_="";const a=()=>{l.length>0&&s(2,V=l[Math.floor(Math.random()*l.length)]),p()},h=()=>{s(1,d=""),s(0,o.value="",o),s(3,v=!1)},k=()=>{s(3,v=!0);const I=V==null?void 0:V.srs;if(I){const Q=Ie(I,f);m("srs",{sentence:V,srs:Q})}},p=()=>{o&&o.focus()},w=I=>{c=/[a-zA-Z0-9]/.test(I),s(4,_=c?"Invalid characters in input!":"")};let V=null;de(()=>{a(),window.addEventListener("keydown",I=>{if(I.key==="Enter"){if(w(d),c)return;u&&V&&v?(h(),a()):k()}})});function j(I){_e[I?"unshift":"push"](()=>{o=I,s(0,o)})}return r.$$set=I=>{"selectedDeck"in I&&s(8,u=I.selectedDeck)},r.$$.update=()=>{r.$$.dirty&256&&(l=u?$(u):[]),r.$$.dirty&256&&u&&(l=u?$(u):[],a()),r.$$.dirty&1&&o&&(s(0,o.value="",o),o&&Ce(o),o.addEventListener("input",I=>{s(1,d=I.target.value)}),p()),r.$$.dirty&6&&s(9,i=V&&Se(V,d)),r.$$.dirty&512&&s(7,n=i&&i.answerCorrectness.map(I=>I?"#94f77e":"#f25f44")),r.$$.dirty&512&&s(6,t=i&&i.readingCorrectness.map(I=>I?"#94f77e":"#f25f44")),r.$$.dirty&512&&s(5,f=i?i.isCorrect:!1)},[o,d,V,v,_,f,t,n,u,i,j]}class Le extends ve{constructor(e){super(),ge(this,e,Me,ye,ue,{selectedDeck:8})}}function ne(r,e,s){const l=r.slice();return l[12]=e[s],l[14]=s,l}function re(r,e,s){const l=r.slice();return l[12]=e[s],l[14]=s,l}function ie(r){let e,s,l="Choose a deck:",i,n,t,f,u=`<a href="${`${Ee}/decks`}">Manage Decks</a>`,m,o,d=F(r[0]),v=[];for(let c=0;c<d.length;c+=1)v[c]=ae(re(r,d,c));return{c(){e=C("form"),s=C("label"),s.textContent=l,i=y(),n=C("select");for(let c=0;c<v.length;c+=1)v[c].c();t=y(),f=C("p"),f.innerHTML=u,this.h()},l(c){e=E(c,"FORM",{});var _=S(e);s=E(_,"LABEL",{for:!0,"data-svelte-h":!0}),J(s)!=="svelte-smnxxd"&&(s.textContent=l),i=M(_),n=E(_,"SELECT",{name:!0,id:!0});var a=S(n);for(let h=0;h<v.length;h+=1)v[h].l(a);a.forEach(g),_.forEach(g),t=M(c),f=E(c,"P",{"data-svelte-h":!0}),J(f)!=="svelte-19nwu32"&&(f.innerHTML=u),this.h()},h(){D(s,"for","decks"),D(n,"name","decks"),D(n,"id","decks"),r[1]===void 0&&he(()=>r[5].call(n))},m(c,_){b(c,e,_),A(e,s),A(e,i),A(e,n);for(let a=0;a<v.length;a+=1)v[a]&&v[a].m(n,null);z(n,r[1],!0),b(c,t,_),b(c,f,_),m||(o=[H(n,"change",r[5]),H(n,"change",r[6])],m=!0)},p(c,_){if(_&1){d=F(c[0]);let a;for(a=0;a<d.length;a+=1){const h=re(c,d,a);v[a]?v[a].p(h,_):(v[a]=ae(h),v[a].c(),v[a].m(n,null))}for(;a<v.length;a+=1)v[a].d(1);v.length=d.length}_&3&&z(n,c[1])},d(c){c&&(g(e),g(t),g(f)),pe(v,c),m=!1,me(o)}}}function ae(r){let e,s=r[12].name+"",l,i;return{c(){e=C("option"),l=T(s),this.h()},l(n){e=E(n,"OPTION",{});var t=S(e);l=O(t,s),t.forEach(g),this.h()},h(){e.__value=i=r[12],R(e,e.__value)},m(n,t){b(n,e,t),A(e,l)},p(n,t){t&1&&s!==(s=n[12].name+"")&&P(l,s),t&1&&i!==(i=n[12])&&(e.__value=i,R(e,e.__value))},d(n){n&&g(e)}}}function oe(r){let e,s,l="Choose a deck",i,n,t,f,u,m=F(r[0]),o=[];for(let d=0;d<m.length;d+=1)o[d]=ce(ne(r,m,d));return{c(){e=C("div"),s=C("h1"),s.textContent=l,i=y(),n=C("form"),t=C("select");for(let d=0;d<o.length;d+=1)o[d].c();this.h()},l(d){e=E(d,"DIV",{class:!0});var v=S(e);s=E(v,"H1",{class:!0,"data-svelte-h":!0}),J(s)!=="svelte-1mswgjr"&&(s.textContent=l),i=M(v),n=E(v,"FORM",{});var c=S(n);t=E(c,"SELECT",{name:!0,id:!0,class:!0});var _=S(t);for(let a=0;a<o.length;a+=1)o[a].l(_);_.forEach(g),c.forEach(g),v.forEach(g),this.h()},h(){D(s,"class","svelte-zcy7mq"),D(t,"name","decks"),D(t,"id","decks"),D(t,"class","svelte-zcy7mq"),r[1]===void 0&&he(()=>r[7].call(t)),D(e,"class","pick-decks-container svelte-zcy7mq")},m(d,v){b(d,e,v),A(e,s),A(e,i),A(e,n),A(n,t);for(let c=0;c<o.length;c+=1)o[c]&&o[c].m(t,null);z(t,r[1],!0),f||(u=[H(t,"change",r[7]),H(t,"change",r[8])],f=!0)},p(d,v){if(v&1){m=F(d[0]);let c;for(c=0;c<m.length;c+=1){const _=ne(d,m,c);o[c]?o[c].p(_,v):(o[c]=ce(_),o[c].c(),o[c].m(t,null))}for(;c<o.length;c+=1)o[c].d(1);o.length=m.length}v&3&&z(t,d[1])},d(d){d&&g(e),pe(o,d),f=!1,me(u)}}}function ce(r){let e,s=r[12].name+"",l,i;return{c(){e=C("option"),l=T(s),this.h()},l(n){e=E(n,"OPTION",{});var t=S(e);l=O(t,s),t.forEach(g),this.h()},h(){e.__value=i=r[12],R(e,e.__value)},m(n,t){b(n,e,t),A(e,l)},p(n,t){t&1&&s!==(s=n[12].name+"")&&P(l,s),t&1&&i!==(i=n[12])&&(e.__value=i,R(e,e.__value))},d(n){n&&g(e)}}}function fe(r){let e,s,l;function i(t){r[9](t)}let n={};return r[1]!==void 0&&(n.selectedDeck=r[1]),e=new Le({props:n}),_e.push(()=>be(e,"selectedDeck",i)),e.$on("srs",r[10]),{c(){K(e.$$.fragment)},l(t){U(e.$$.fragment,t)},m(t,f){B(e,t,f),l=!0},p(t,f){const u={};!s&&f&2&&(s=!0,u.selectedDeck=t[1],we(()=>s=!1)),e.$set(u)},i(t){l||(L(e.$$.fragment,t),l=!0)},o(t){N(e.$$.fragment,t),l=!1},d(t){W(e,t)}}}function Ne(r){let e,s,l,i,n,t=r[2]&&ie(r),f=r[3]&&oe(r),u=r[2]&&fe(r);return{c(){e=C("div"),t&&t.c(),s=y(),l=C("div"),f&&f.c(),i=y(),u&&u.c(),this.h()},l(m){e=E(m,"DIV",{class:!0});var o=S(e);t&&t.l(o),s=M(o),l=E(o,"DIV",{class:!0});var d=S(l);f&&f.l(d),i=M(d),u&&u.l(d),d.forEach(g),o.forEach(g),this.h()},h(){D(l,"class","container svelte-zcy7mq"),D(e,"class","page")},m(m,o){b(m,e,o),t&&t.m(e,null),A(e,s),A(e,l),f&&f.m(l,null),A(l,i),u&&u.m(l,null),n=!0},p(m,[o]){m[2]?t?t.p(m,o):(t=ie(m),t.c(),t.m(e,s)):t&&(t.d(1),t=null),m[3]?f?f.p(m,o):(f=oe(m),f.c(),f.m(l,i)):f&&(f.d(1),f=null),m[2]?u?(u.p(m,o),o&4&&L(u,1)):(u=fe(m),u.c(),L(u,1),u.m(l,null)):u&&(Z(),N(u,1,1,()=>{u=null}),G())},i(m){n||(L(u),n=!0)},o(m){N(u),n=!1},d(m){m&&g(e),t&&t.d(),f&&f.d(),u&&u.d()}}}function Te(r,e,s){let l,i,n=[],t;const f=(_,a)=>{const h=t,k=_,p=n.findIndex(V=>V===h),w=h.sentences.findIndex(V=>V===k);p!==-1&&w!==-1&&console.log(h.sentences[w]),p!==-1&&w!==-1&&(h.sentences[w]={...k,srs:a},s(0,n[p]=h,n)),localStorage.setItem("decks",JSON.stringify(n))};de(()=>{const _=localStorage.getItem("decks");_&&s(0,n=JSON.parse(_)),(!_||n.length==0)&&s(0,n=[{name:"Default Deck",description:"This is a default deck",sentences:[Ae]}])});function u(){t=Y(this),s(1,t),s(0,n)}const m=()=>console.log(t);function o(){t=Y(this),s(1,t),s(0,n)}const d=()=>console.log(t);function v(_){t=_,s(1,t)}const c=_=>{f(_.detail.sentence,_.detail.srs)};return r.$$.update=()=>{r.$$.dirty&1&&n.length,r.$$.dirty&3&&s(3,l=n.length>0&&t===null),r.$$.dirty&2&&s(2,i=t!==null)},[n,t,i,l,f,u,m,o,d,v,c]}class He extends ve{constructor(e){super(),ge(this,e,Te,Ne,ue,{})}}export{He as component};
