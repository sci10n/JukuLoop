import{s as _e,e as k,t as z,d as p,f as S,h as F,i as v,w as He,k as J,l as c,m as oe,n as ce,v as E,T as Se,b as R,j as M,U as te,Y as ee,W as K,C as Ne,r as je,x as we,E as at,V as Pe,X as rt,_ as it,Z as De}from"../chunks/scheduler.BGfZ2OPz.js";import{S as ve,i as ge,g as fe,a as U,c as he,t as V,b as se,d as le,m as ae,e as re,h as Te}from"../chunks/index.CBGtRaXf.js";import{s as Me,a as Xe,S as ot,e as Ee,N as Be,u as nt,o as ct,C as st,g as Ce,h as ut,d as ze,i as lt,j as dt,k as ft,l as ht,f as _t}from"../chunks/crud.3eonXhL3.js";import{b as vt}from"../chunks/paths.BIyN5MlR.js";function gt(l){let e,t=Me(l[0])+"",s;return{c(){e=k("p"),s=z(t),this.h()},l(r){e=p(r,"P",{style:!0});var n=S(e);s=F(n,t),n.forEach(v),this.h()},h(){He(e,"color",Xe(l[0]))},m(r,n){J(r,e,n),c(e,s)},p(r,[n]){n&1&&t!==(t=Me(r[0])+"")&&oe(s,t),n&1&&He(e,"color",Xe(r[0]))},i:ce,o:ce,d(r){r&&v(e)}}}function kt(l,e,t){let{stage:s}=e,{srs:r}=e;return l.$$set=n=>{"stage"in n&&t(0,s=n.stage),"srs"in n&&t(1,r=n.srs)},[s,r]}class pt extends ve{constructor(e){super(),ge(this,e,kt,gt,_e,{stage:0,srs:1})}}function Fe(l,e,t){const s=l.slice();return s[12]=e[t],s}function mt(l){let e,t,s,r,n,a,o,i='<tr><th class="svelte-eaqrys">Translation</th> <th class="svelte-eaqrys">Sentence</th> <th class="svelte-eaqrys">Notes</th> <th class="svelte-eaqrys">Hint</th> <th class="svelte-eaqrys">Stage</th> <th class="svelte-eaqrys">Review</th> <th class="svelte-eaqrys">Actions</th></tr>',d,_,f=[],T=new Map,C,D,w="Add Sentence",I,y,m,g,u,q=Ee(l[3]);const H=h=>h[12].id;for(let h=0;h<q.length;h+=1){let b=Fe(l,q,h),L=H(b);T.set(L,f[h]=Ke(L,b))}return y=new Be({props:{view:[{to:"cancel",label:"Cancel",active:!0},{to:"save",label:"Save",active:!0}]}}),y.$on("navigate",l[11]),{c(){e=k("div"),t=k("input"),s=R(),r=k("textarea"),n=R(),a=k("table"),o=k("thead"),o.innerHTML=i,d=R(),_=k("tbody");for(let h=0;h<f.length;h+=1)f[h].c();C=R(),D=k("button"),D.textContent=w,I=R(),se(y.$$.fragment),this.h()},l(h){e=p(h,"DIV",{class:!0});var b=S(e);t=p(b,"INPUT",{placeholder:!0,class:!0}),s=M(b),r=p(b,"TEXTAREA",{placeholder:!0,class:!0}),S(r).forEach(v),b.forEach(v),n=M(h),a=p(h,"TABLE",{class:!0});var L=S(a);o=p(L,"THEAD",{"data-svelte-h":!0}),te(o)!=="svelte-8zpm6h"&&(o.innerHTML=i),d=M(L),_=p(L,"TBODY",{});var O=S(_);for(let $=0;$<f.length;$+=1)f[$].l(O);O.forEach(v),L.forEach(v),C=M(h),D=p(h,"BUTTON",{class:!0,"data-svelte-h":!0}),te(D)!=="svelte-1f1ee0k"&&(D.textContent=w),I=M(h),le(y.$$.fragment,h),this.h()},h(){E(t,"placeholder","Deck Name"),E(t,"class","svelte-eaqrys"),E(r,"placeholder","Deck Description"),E(r,"class","svelte-eaqrys"),E(e,"class","deck-info svelte-eaqrys"),E(a,"class","sentence-table svelte-eaqrys"),E(D,"class","primary add-sentence svelte-eaqrys")},m(h,b){J(h,e,b),c(e,t),ee(t,l[1]),c(e,s),c(e,r),ee(r,l[2]),J(h,n,b),J(h,a,b),c(a,o),c(a,d),c(a,_);for(let L=0;L<f.length;L+=1)f[L]&&f[L].m(_,null);J(h,C,b),J(h,D,b),J(h,I,b),ae(y,h,b),m=!0,g||(u=[K(t,"input",l[8]),K(r,"input",l[9]),K(D,"click",l[6])],g=!0)},p(h,b){b&2&&t.value!==h[1]&&ee(t,h[1]),b&4&&ee(r,h[2]),b&25&&(q=Ee(h[3]),fe(),f=nt(f,b,H,1,h,q,T,_,ct,Ke,null,Fe),he())},i(h){if(!m){for(let b=0;b<q.length;b+=1)V(f[b]);V(y.$$.fragment,h),m=!0}},o(h){for(let b=0;b<f.length;b+=1)U(f[b]);U(y.$$.fragment,h),m=!1},d(h){h&&(v(e),v(n),v(a),v(C),v(D),v(I));for(let b=0;b<f.length;b+=1)f[b].d();re(y,h),g=!1,Ne(u)}}}function bt(l){let e,t="Deck not found";return{c(){e=k("p"),e.textContent=t},l(s){e=p(s,"P",{"data-svelte-h":!0}),te(e)!=="svelte-vs2gpw"&&(e.textContent=t)},m(s,r){J(s,e,r)},p:ce,i:ce,o:ce,d(s){s&&v(e)}}}function Ye(l){let e,t;return e=new pt({props:{stage:l[12].srs.stage,srs:l[12].srs}}),{c(){se(e.$$.fragment)},l(s){le(e.$$.fragment,s)},m(s,r){ae(e,s,r),t=!0},p(s,r){const n={};r&8&&(n.stage=s[12].srs.stage),r&8&&(n.srs=s[12].srs),e.$set(n)},i(s){t||(V(e.$$.fragment,s),t=!0)},o(s){U(e.$$.fragment,s),t=!1},d(s){re(e,s)}}}function Je(l){let e=Ce(l[12].srs)+"",t;return{c(){t=z(e)},l(s){t=F(s,e)},m(s,r){J(s,t,r)},p(s,r){r&8&&e!==(e=Ce(s[12].srs)+"")&&oe(t,e)},d(s){s&&v(t)}}}function Ke(l,e){let t,s,r=e[12].translation+"",n,a,o,i,d,_,f=e[12].note+"",T,C,D,w=e[12].hint+"",I,y,m,g,u,q,H,h,b="Edit",L,O,$,W;i=new st({props:{readings:e[12].reading,furigana:e[12].furigana,colors:e[12].optional.map(We)}});let j=e[12].srs&&Ye(e),B=e[12].srs&&Je(e);function ke(){return e[10](e[12])}return{key:l,first:null,c(){t=k("tr"),s=k("td"),n=z(r),a=R(),o=k("td"),se(i.$$.fragment),d=R(),_=k("td"),T=z(f),C=R(),D=k("td"),I=z(w),y=R(),m=k("td"),j&&j.c(),g=R(),u=k("td"),B&&B.c(),q=R(),H=k("td"),h=k("button"),h.textContent=b,L=R(),this.h()},l(P){t=p(P,"TR",{});var N=S(t);s=p(N,"TD",{class:!0});var G=S(s);n=F(G,r),G.forEach(v),a=M(N),o=p(N,"TD",{class:!0});var ne=S(o);le(i.$$.fragment,ne),ne.forEach(v),d=M(N),_=p(N,"TD",{class:!0});var ue=S(_);T=F(ue,f),ue.forEach(v),C=M(N),D=p(N,"TD",{class:!0});var Q=S(D);I=F(Q,w),Q.forEach(v),y=M(N),m=p(N,"TD",{class:!0});var pe=S(m);j&&j.l(pe),pe.forEach(v),g=M(N),u=p(N,"TD",{class:!0});var de=S(u);B&&B.l(de),de.forEach(v),q=M(N),H=p(N,"TD",{class:!0});var x=S(H);h=p(x,"BUTTON",{class:!0,"data-svelte-h":!0}),te(h)!=="svelte-dkigzt"&&(h.textContent=b),x.forEach(v),L=M(N),N.forEach(v),this.h()},h(){E(s,"class","svelte-eaqrys"),E(o,"class","reading svelte-eaqrys"),E(_,"class","svelte-eaqrys"),E(D,"class","svelte-eaqrys"),E(m,"class","srs-container svelte-eaqrys"),E(u,"class","svelte-eaqrys"),E(h,"class","primary svelte-eaqrys"),E(H,"class","svelte-eaqrys"),this.first=t},m(P,N){J(P,t,N),c(t,s),c(s,n),c(t,a),c(t,o),ae(i,o,null),c(t,d),c(t,_),c(_,T),c(t,C),c(t,D),c(D,I),c(t,y),c(t,m),j&&j.m(m,null),c(t,g),c(t,u),B&&B.m(u,null),c(t,q),c(t,H),c(H,h),c(t,L),O=!0,$||(W=K(h,"click",ke),$=!0)},p(P,N){e=P,(!O||N&8)&&r!==(r=e[12].translation+"")&&oe(n,r);const G={};N&8&&(G.readings=e[12].reading),N&8&&(G.furigana=e[12].furigana),N&8&&(G.colors=e[12].optional.map(We)),i.$set(G),(!O||N&8)&&f!==(f=e[12].note+"")&&oe(T,f),(!O||N&8)&&w!==(w=e[12].hint+"")&&oe(I,w),e[12].srs?j?(j.p(e,N),N&8&&V(j,1)):(j=Ye(e),j.c(),V(j,1),j.m(m,null)):j&&(fe(),U(j,1,1,()=>{j=null}),he()),e[12].srs?B?B.p(e,N):(B=Je(e),B.c(),B.m(u,null)):B&&(B.d(1),B=null)},i(P){O||(V(i.$$.fragment,P),V(j),O=!0)},o(P){U(i.$$.fragment,P),U(j),O=!1},d(P){P&&v(t),re(i),j&&j.d(),B&&B.d(),$=!1,W()}}}function wt(l){let e,t,s,r;const n=[bt,mt],a=[];function o(i,d){return i[0]?1:0}return t=o(l),s=a[t]=n[t](l),{c(){e=k("div"),s.c(),this.h()},l(i){e=p(i,"DIV",{class:!0});var d=S(e);s.l(d),d.forEach(v),this.h()},h(){E(e,"class","container svelte-eaqrys")},m(i,d){J(i,e,d),a[t].m(e,null),r=!0},p(i,[d]){let _=t;t=o(i),t===_?a[t].p(i,d):(fe(),U(a[_],1,1,()=>{a[_]=null}),he(),s=a[t],s?s.p(i,d):(s=a[t]=n[t](i),s.c()),V(s,1),s.m(e,null))},i(i){r||(V(s),r=!0)},o(i){U(s),r=!1},d(i){i&&v(e),a[t].d()}}}const We=l=>l?"blue":"black";function Et(l,e,t){let s;const r=Se();let{deckMetadata:n}=e,{storage:a}=e,o=n.name,i=n.description;function d(){t(0,n.name=o,n),t(0,n.description=i,n),a.addOrUpdateDeck(n),r("navigate",{to:"decks"})}function _(){const I={id:Math.random().toString(36).substring(7),furigana:[],hint:"",note:"",optional:[],optionalCluster:[],raw:"",reading:[],srs:{stage:ot.Apprentice1,nextReview:new Date,lastReview:new Date,streak:0,maxStreak:0},translation:""};r("edit",{deck:n,sentence:I})}function f(){o=this.value,t(1,o)}function T(){i=this.value,t(2,i)}const C=w=>r("edit",{deck:n,sentence:w}),D=w=>w.detail.to==="save"?d():r("cancel");return l.$$set=w=>{"deckMetadata"in w&&t(0,n=w.deckMetadata),"storage"in w&&t(7,a=w.storage)},l.$$.update=()=>{l.$$.dirty&129&&t(3,s=n&&a&&a.getSentencesForDeck(n.id))},[n,o,i,s,r,d,_,a,f,T,C,D]}class Dt extends ve{constructor(e){super(),ge(this,e,Et,wt,_e,{deckMetadata:0,storage:7})}}function Ze(l,e,t){const s=l.slice();return s[8]=e[t],s}function Ge(l,e){let t,s,r=e[8].name+"",n,a,o=e[8].sentenceIds.length+"",i,d,_,f,T=e[8].description+"",C,D,w,I,y="Edit",m,g,u="Delete",q,H,h;function b(){return e[5](e[8])}function L(){return e[6](e[8])}return{key:l,first:null,c(){t=k("div"),s=k("h2"),n=z(r),a=z(" ("),i=z(o),d=z(")"),_=R(),f=k("p"),C=z(T),D=R(),w=k("div"),I=k("button"),I.textContent=y,m=R(),g=k("button"),g.textContent=u,q=R(),this.h()},l(O){t=p(O,"DIV",{class:!0});var $=S(t);s=p($,"H2",{class:!0});var W=S(s);n=F(W,r),a=F(W," ("),i=F(W,o),d=F(W,")"),W.forEach(v),_=M($),f=p($,"P",{});var j=S(f);C=F(j,T),j.forEach(v),D=M($),w=p($,"DIV",{class:!0});var B=S(w);I=p(B,"BUTTON",{class:!0,"data-svelte-h":!0}),te(I)!=="svelte-xkyu9k"&&(I.textContent=y),m=M(B),g=p(B,"BUTTON",{class:!0,"data-svelte-h":!0}),te(g)!=="svelte-1v25wbx"&&(g.textContent=u),B.forEach(v),q=M($),$.forEach(v),this.h()},h(){E(s,"class","svelte-1jx2618"),E(I,"class","edit-button svelte-1jx2618"),E(g,"class","delete-button svelte-1jx2618"),E(w,"class","deck-actions svelte-1jx2618"),E(t,"class","deck-card svelte-1jx2618"),this.first=t},m(O,$){J(O,t,$),c(t,s),c(s,n),c(s,a),c(s,i),c(s,d),c(t,_),c(t,f),c(f,C),c(t,D),c(t,w),c(w,I),c(w,m),c(w,g),c(t,q),H||(h=[K(I,"click",b),K(g,"click",L)],H=!0)},p(O,$){e=O,$&1&&r!==(r=e[8].name+"")&&oe(n,r),$&1&&o!==(o=e[8].sentenceIds.length+"")&&oe(i,o),$&1&&T!==(T=e[8].description+"")&&oe(C,T)},d(O){O&&v(t),H=!1,Ne(h)}}}function Tt(l){let e,t,s="Decks",r,n,a=[],o=new Map,i,d,_="Add Deck",f,T,C,D,w,I=Ee(l[0]);const y=m=>m[8].id;for(let m=0;m<I.length;m+=1){let g=Ze(l,I,m),u=y(g);o.set(u,a[m]=Ge(u,g))}return T=new Be({props:{view:[{to:"review",label:"Review",active:!0},{to:"decks",label:"Edit Decks",active:!1}]}}),T.$on("navigate",l[7]),{c(){e=k("div"),t=k("h1"),t.textContent=s,r=R(),n=k("div");for(let m=0;m<a.length;m+=1)a[m].c();i=R(),d=k("button"),d.textContent=_,f=R(),se(T.$$.fragment),this.h()},l(m){e=p(m,"DIV",{class:!0});var g=S(e);t=p(g,"H1",{"data-svelte-h":!0}),te(t)!=="svelte-1txjx0s"&&(t.textContent=s),r=M(g),n=p(g,"DIV",{class:!0});var u=S(n);for(let q=0;q<a.length;q+=1)a[q].l(u);u.forEach(v),i=M(g),d=p(g,"BUTTON",{class:!0,"data-svelte-h":!0}),te(d)!=="svelte-2g2ez9"&&(d.textContent=_),f=M(g),le(T.$$.fragment,g),g.forEach(v),this.h()},h(){E(n,"class","deck-list svelte-1jx2618"),E(d,"class","add-deck-button svelte-1jx2618"),E(e,"class","decks-view svelte-1jx2618")},m(m,g){J(m,e,g),c(e,t),c(e,r),c(e,n);for(let u=0;u<a.length;u+=1)a[u]&&a[u].m(n,null);c(e,i),c(e,d),c(e,f),ae(T,e,null),C=!0,D||(w=K(d,"click",l[2]),D=!0)},p(m,[g]){g&11&&(I=Ee(m[0]),a=nt(a,g,y,1,m,I,o,n,ut,Ge,null,Ze))},i(m){C||(V(T.$$.fragment,m),C=!0)},o(m){U(T.$$.fragment,m),C=!1},d(m){m&&v(e);for(let g=0;g<a.length;g+=1)a[g].d();re(T),D=!1,w()}}}function Ct(l,e,t){const s=Se();let{decks:r=[]}=e,{storage:n}=e;function a(){const f=prompt("Enter the name of the deck"),T=prompt("Enter the description of the deck");if(f&&T){const D={id:Math.random().toString(36).substring(7),name:f,description:T,sentenceIds:[]};n.addOrUpdateDeck(D),t(0,r=n.getDecks())}}function o(f){confirm("Are you sure you want to delete this deck?")&&(n.deleteDeck(f),t(0,r=n.getDecks()))}je(()=>{});const i=f=>s("edit",{deck:f}),d=f=>o(f.id),_=f=>s("navigate",{to:f.detail.to});return l.$$set=f=>{"decks"in f&&t(0,r=f.decks),"storage"in f&&t(4,n=f.storage)},[r,s,a,o,n,i,d,_]}class St extends ve{constructor(e){super(),ge(this,e,Ct,Tt,_e,{decks:0,storage:4})}}function qt(l){let e;return{c(){e=k("textarea"),this.h()},l(t){e=p(t,"TEXTAREA",{class:!0}),S(e).forEach(v),this.h()},h(){e.value=l[0],E(e,"class","svelte-lhjhtv")},m(t,s){J(t,e,s),l[2](e)},p(t,[s]){s&1&&(e.value=t[0])},i:ce,o:ce,d(t){t&&v(e),l[2](null)}}}function At(l,e,t){const s=Se();let{value:r}=e,n;je(()=>{ze(n),n.addEventListener("input",o=>{t(0,r=o.target.value)}),t(1,n.value=r,n)});function a(o){we[o?"unshift":"push"](()=>{n=o,t(1,n)})}return l.$$set=o=>{"value"in o&&t(0,r=o.value)},l.$$.update=()=>{l.$$.dirty&2&&n&&(n&&ze(n),n.addEventListener("input",o=>{t(0,r=o.target.value)})),l.$$.dirty&1&&r&&s("input",r)},[r,n,a]}class It extends ve{constructor(e){super(),ge(this,e,At,qt,_e,{value:0})}}function $t(l,e,t){const s=l.slice();return s[17]=e[t],s}function yt(l){let e,t=Me(l[17])+"",s;return{c(){e=k("option"),s=z(t),this.h()},l(r){e=p(r,"OPTION",{});var n=S(e);s=F(n,t),n.forEach(v),this.h()},h(){e.__value=l[17],ee(e,e.__value)},m(r,n){J(r,e,n),c(e,s)},p:ce,d(r){r&&v(e)}}}function Lt(l){let e,t,s="Edit Sentence",r,n,a,o,i,d,_,f,T,C,D,w,I,y,m,g,u,q,H,h,b,L,O,$,W,j=Ce(l[0].srs)+"",B,ke,P,N="Reset SRS",G,ne,ue,Q,pe="Delete Sentence",de,x,me,qe,Ve;a=new It({props:{value:l[0].raw}}),a.$on("input",l[8]),i=new st({props:{readings:l[0].reading,furigana:l[0].furigana,colors:l[0].optional.map(Qe)}});let Oe=Ee(lt),ie=[];for(let A=0;A<Oe.length;A+=1)ie[A]=yt($t(l,Oe,A));return x=new Be({props:{view:[{to:"cancel",label:"Cancel",active:!0},{to:"save",label:"Save",active:!0}]}}),x.$on("navigate",l[16]),{c(){e=k("div"),t=k("h1"),t.textContent=s,r=R(),n=k("div"),se(a.$$.fragment),o=R(),se(i.$$.fragment),d=R(),_=k("div"),f=k("label"),T=z(`Translation\r
            `),C=k("input"),D=R(),w=k("label"),I=z(`Notes\r
            `),y=k("textarea"),m=R(),g=k("label"),u=z(`Hint\r
            `),q=k("textarea"),H=R(),h=k("label"),b=z(`SRS Stage\r
            `),L=k("select");for(let A=0;A<ie.length;A+=1)ie[A].c();O=R(),$=k("label"),W=z("Time until Review: "),B=z(j),ke=R(),P=k("button"),P.textContent=N,G=R(),ne=k("label"),ue=z(`Delete\r
            `),Q=k("button"),Q.textContent=pe,de=R(),se(x.$$.fragment),this.h()},l(A){e=p(A,"DIV",{class:!0});var X=S(e);t=p(X,"H1",{"data-svelte-h":!0}),te(t)!=="svelte-x8bscl"&&(t.textContent=s),r=M(X),n=p(X,"DIV",{class:!0});var Z=S(n);le(a.$$.fragment,Z),o=M(Z),le(i.$$.fragment,Z),Z.forEach(v),d=M(X),_=p(X,"DIV",{class:!0});var Y=S(_);f=p(Y,"LABEL",{class:!0});var Ae=S(f);T=F(Ae,`Translation\r
            `),C=p(Ae,"INPUT",{class:!0}),Ae.forEach(v),D=M(Y),w=p(Y,"LABEL",{class:!0});var Ie=S(w);I=F(Ie,`Notes\r
            `),y=p(Ie,"TEXTAREA",{class:!0}),S(y).forEach(v),Ie.forEach(v),m=M(Y),g=p(Y,"LABEL",{class:!0});var $e=S(g);u=F($e,`Hint\r
            `),q=p($e,"TEXTAREA",{class:!0}),S(q).forEach(v),$e.forEach(v),H=M(Y),h=p(Y,"LABEL",{class:!0});var ye=S(h);b=F(ye,`SRS Stage\r
            `),L=p(ye,"SELECT",{class:!0});var Ue=S(L);for(let Re=0;Re<ie.length;Re+=1)ie[Re].l(Ue);Ue.forEach(v),ye.forEach(v),O=M(Y),$=p(Y,"LABEL",{class:!0});var be=S($);W=F(be,"Time until Review: "),B=F(be,j),ke=M(be),P=p(be,"BUTTON",{class:!0,"data-svelte-h":!0}),te(P)!=="svelte-1cluvep"&&(P.textContent=N),be.forEach(v),G=M(Y),ne=p(Y,"LABEL",{class:!0});var Le=S(ne);ue=F(Le,`Delete\r
            `),Q=p(Le,"BUTTON",{class:!0,"data-svelte-h":!0}),te(Q)!=="svelte-1kuu88f"&&(Q.textContent=pe),Le.forEach(v),Y.forEach(v),de=M(X),le(x.$$.fragment,X),X.forEach(v),this.h()},h(){E(n,"class","sentence-input svelte-6khvqs"),E(C,"class","svelte-6khvqs"),E(f,"class","svelte-6khvqs"),E(y,"class","svelte-6khvqs"),E(w,"class","svelte-6khvqs"),E(q,"class","svelte-6khvqs"),E(g,"class","svelte-6khvqs"),E(L,"class","svelte-6khvqs"),l[0].srs.stage===void 0&&at(()=>l[15].call(L)),E(h,"class","svelte-6khvqs"),E(P,"class","reset-btn svelte-6khvqs"),E($,"class","svelte-6khvqs"),E(Q,"class","reset-btn svelte-6khvqs"),E(ne,"class","svelte-6khvqs"),E(_,"class","form-grid svelte-6khvqs"),E(e,"class","edit-container svelte-6khvqs")},m(A,X){J(A,e,X),c(e,t),c(e,r),c(e,n),ae(a,n,null),c(n,o),ae(i,n,null),c(e,d),c(e,_),c(_,f),c(f,T),c(f,C),ee(C,l[0].translation),c(_,D),c(_,w),c(w,I),c(w,y),ee(y,l[0].note),c(_,m),c(_,g),c(g,u),c(g,q),ee(q,l[0].hint),c(_,H),c(_,h),c(h,b),c(h,L);for(let Z=0;Z<ie.length;Z+=1)ie[Z]&&ie[Z].m(L,null);Pe(L,l[0].srs.stage,!0),c(_,O),c(_,$),c($,W),c($,B),c($,ke),c($,P),c(_,G),c(_,ne),c(ne,ue),c(ne,Q),c(e,de),ae(x,e,null),me=!0,qe||(Ve=[K(C,"input",l[9]),K(C,"input",l[10]),K(y,"input",l[11]),K(y,"input",l[12]),K(q,"input",l[13]),K(q,"input",l[14]),K(L,"change",l[15]),K(P,"click",l[4]),K(Q,"click",l[3])],qe=!0)},p(A,[X]){const Z={};X&1&&(Z.value=A[0].raw),a.$set(Z);const Y={};X&1&&(Y.readings=A[0].reading),X&1&&(Y.furigana=A[0].furigana),X&1&&(Y.colors=A[0].optional.map(Qe)),i.$set(Y),X&1&&C.value!==A[0].translation&&ee(C,A[0].translation),X&1&&ee(y,A[0].note),X&1&&ee(q,A[0].hint),X&1&&Pe(L,A[0].srs.stage),(!me||X&1)&&j!==(j=Ce(A[0].srs)+"")&&oe(B,j)},i(A){me||(V(a.$$.fragment,A),V(i.$$.fragment,A),V(x.$$.fragment,A),me=!0)},o(A){U(a.$$.fragment,A),U(i.$$.fragment,A),U(x.$$.fragment,A),me=!1},d(A){A&&v(e),re(a),re(i),rt(ie,A),re(x),qe=!1,Ne(Ve)}}}const Qe=l=>l?"blue":"black";function Rt(l,e,t){const s=Se();let{deck:r=null}=e,{sentence:n}=e,{storage:a}=e;function o(u,q){if(u==="raw"){const H=q.split("").map(dt).join(""),h=ft(H),{reading:b,furigana:L,optional:O,optionalCluster:$}=ht(h);t(0,n={...n,raw:H,reading:b,furigana:L,optional:O,optionalCluster:$})}else t(0,n={...n,[u]:q})}const i=()=>{confirm("Are you sure you want to delete this sentence?")&&(r&&a.removeSentenceFromDeck(r.id,n.id),a.deleteSentence(n.id),s("cancel"))};function d(){t(0,n.srs={...n.srs,streak:0,maxStreak:0,stage:lt[0],nextReview:new Date},n)}function _(){a.addOrUpdateSentence(n),r&&a.addSentenceToDeck(r.id,n.id),s("edit",{deck:r,sentence:n})}const f=u=>o("raw",u.detail);function T(){n.translation=this.value,t(0,n)}const C=u=>o("translation",u.target.value);function D(){n.note=this.value,t(0,n)}const w=u=>o("note",u.target.value);function I(){n.hint=this.value,t(0,n)}const y=u=>o("hint",u.target.value);function m(){n.srs.stage=it(this),t(0,n)}const g=u=>u.detail.to==="save"?_():s("cancel");return l.$$set=u=>{"deck"in u&&t(6,r=u.deck),"sentence"in u&&t(0,n=u.sentence),"storage"in u&&t(7,a=u.storage)},[n,s,o,i,d,_,r,a,f,T,C,D,w,I,y,m,g]}class Mt extends ve{constructor(e){super(),ge(this,e,Rt,Lt,_e,{deck:6,sentence:0,storage:7})}}function xe(l){let e,t,s;function r(a){l[6](a)}let n={storage:l[0]};return l[1]!==void 0&&(n.decks=l[1]),e=new St({props:n}),we.push(()=>Te(e,"decks",r)),e.$on("edit",l[7]),e.$on("navigate",l[8]),{c(){se(e.$$.fragment)},l(a){le(e.$$.fragment,a)},m(a,o){ae(e,a,o),s=!0},p(a,o){const i={};o&1&&(i.storage=a[0]),!t&&o&2&&(t=!0,i.decks=a[1],De(()=>t=!1)),e.$set(i)},i(a){s||(V(e.$$.fragment,a),s=!0)},o(a){U(e.$$.fragment,a),s=!1},d(a){re(e,a)}}}function et(l){let e,t,s;function r(a){l[9](a)}let n={storage:l[0]};return l[2]!==void 0&&(n.deckMetadata=l[2]),e=new Dt({props:n}),we.push(()=>Te(e,"deckMetadata",r)),e.$on("edit",l[10]),e.$on("cancel",l[11]),e.$on("navigate",l[12]),{c(){se(e.$$.fragment)},l(a){le(e.$$.fragment,a)},m(a,o){ae(e,a,o),s=!0},p(a,o){const i={};o&1&&(i.storage=a[0]),!t&&o&4&&(t=!0,i.deckMetadata=a[2],De(()=>t=!1)),e.$set(i)},i(a){s||(V(e.$$.fragment,a),s=!0)},o(a){U(e.$$.fragment,a),s=!1},d(a){re(e,a)}}}function tt(l){let e,t,s,r;function n(i){l[13](i)}function a(i){l[14](i)}let o={storage:l[0]};return l[2]!==void 0&&(o.deck=l[2]),l[3]!==void 0&&(o.sentence=l[3]),e=new Mt({props:o}),we.push(()=>Te(e,"deck",n)),we.push(()=>Te(e,"sentence",a)),e.$on("edit",l[15]),e.$on("cancel",l[16]),{c(){se(e.$$.fragment)},l(i){le(e.$$.fragment,i)},m(i,d){ae(e,i,d),r=!0},p(i,d){const _={};d&1&&(_.storage=i[0]),!t&&d&4&&(t=!0,_.deck=i[2],De(()=>t=!1)),!s&&d&8&&(s=!0,_.sentence=i[3],De(()=>s=!1)),e.$set(_)},i(i){r||(V(e.$$.fragment,i),r=!0)},o(i){U(e.$$.fragment,i),r=!1},d(i){re(e,i)}}}function Nt(l){let e,t,s,r,n=l[4]==="decks"&&xe(l),a=l[4]==="edit-deck"&&l[2]&&et(l),o=l[4]==="edit-card"&&l[2]&&l[3]&&tt(l);return{c(){e=k("div"),n&&n.c(),t=R(),a&&a.c(),s=R(),o&&o.c(),this.h()},l(i){e=p(i,"DIV",{class:!0});var d=S(e);n&&n.l(d),t=M(d),a&&a.l(d),s=M(d),o&&o.l(d),d.forEach(v),this.h()},h(){E(e,"class","container svelte-1365wnv")},m(i,d){J(i,e,d),n&&n.m(e,null),c(e,t),a&&a.m(e,null),c(e,s),o&&o.m(e,null),r=!0},p(i,[d]){i[4]==="decks"?n?(n.p(i,d),d&16&&V(n,1)):(n=xe(i),n.c(),V(n,1),n.m(e,t)):n&&(fe(),U(n,1,1,()=>{n=null}),he()),i[4]==="edit-deck"&&i[2]?a?(a.p(i,d),d&20&&V(a,1)):(a=et(i),a.c(),V(a,1),a.m(e,s)):a&&(fe(),U(a,1,1,()=>{a=null}),he()),i[4]==="edit-card"&&i[2]&&i[3]?o?(o.p(i,d),d&28&&V(o,1)):(o=tt(i),o.c(),V(o,1),o.m(e,null)):o&&(fe(),U(o,1,1,()=>{o=null}),he())},i(i){r||(V(n),V(a),V(o),r=!0)},o(i){U(n),U(a),U(o),r=!1},d(i){i&&v(e),n&&n.d(),a&&a.d(),o&&o.d()}}}function jt(l,e,t){let s,r=[],n=null,a=null,o="decks";const i=u=>{t(4,o=u),o==="review"&&(window.location.href=`${vt}/`)};je(()=>{t(0,s=_t()),t(1,r=s.getDecks())});function d(u){r=u,t(1,r)}const _=u=>{t(2,n=u.detail.deck),i("edit-deck")},f=u=>{const q=u.detail.to;i(q)};function T(u){n=u,t(2,n)}const C=u=>{t(3,a=u.detail.sentence),i("edit-card")},D=u=>{t(3,a=null),t(2,n=null),i("decks")},w=u=>{const q=u.detail.to;i(q)};function I(u){n=u,t(2,n)}function y(u){a=u,t(3,a)}return[s,r,n,a,o,i,d,_,f,T,C,D,w,I,y,u=>{t(3,a=null),i("edit-deck")},u=>{t(3,a=null),i("edit-deck")}]}class Ht extends ve{constructor(e){super(),ge(this,e,jt,Nt,_e,{})}}export{Ht as component};
