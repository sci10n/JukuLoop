import{L as Me,s as x,e as E,t as T,d as D,f as A,h as j,i as _,B as le,q as y,k as w,l as I,m as O,J as ee,F as De,b as M,z as F,j as N,w as Ie,p as q,X as ne,C as Se,Y as J,r as ye,v as Ae,x as B,Z as Ne,_ as re}from"../chunks/scheduler.BXgHpW_B.js";import{S as te,i as se,f as ie,t as L,g as K,a as H,c as Z,b as U,d as X,m as Y,e as G,h as Ve}from"../chunks/index.CFyXNj5U.js";import{b as Te,e as Q}from"../chunks/index.Dh9Un3aJ.js";import{b as Pe}from"../chunks/paths.B228VVZe.js";import{h as je,s as ae,a as oe,e as $,C as ce,f as He,c as Oe,p as qe}from"../chunks/srs.Dt8SboFV.js";const ze=(i,e)=>{const s=je(e);if(e==="")return{readingCorrectness:Array.from({length:i.reading.length},()=>!1),answerCorrectness:Array.from({length:e.length},()=>!1),isCorrect:!1};const l=Re(s,i),r=e.split("").map((o,d)=>o===l.expectedAnswer[d]),n=l.expectedAnswer.map((o,d)=>o===e[d]),t=Array.from({length:i.reading.length},()=>!0);l.readingMapping.map((o,d)=>{n[d]||(t[o]=!1)});const a=r.every(o=>o),f=t.every(o=>o),c=e.length===l.expectedAnswer.length;return{readingCorrectness:t,answerCorrectness:r,isCorrect:a&&f&&c}},Re=(i,e)=>{const s=[],l=[];for(let r=0;r<e.reading.length;r++){const n=e.furigana[r],t=e.reading[r];i?t.split("").forEach((a,f)=>{s.push(a),l.push(r)}):(n===""?t:n).split("").forEach((f,c)=>{s.push(f),l.push(r)})}return{expectedAnswer:s,readingMapping:l}};function fe(i,{delay:e=0,duration:s=400,easing:l=Me}={}){const r=+getComputedStyle(i).opacity;return{delay:e,duration:s,easing:l,css:n=>`opacity: ${n*r}`}}function Fe(i){let e,s,l=ae(i[0])+"",r,n,t;return{c(){e=E("div"),s=E("p"),r=T(l),this.h()},l(a){e=D(a,"DIV",{class:!0});var f=A(e);s=D(f,"P",{style:!0});var c=A(s);r=j(c,l),c.forEach(_),f.forEach(_),this.h()},h(){le(s,"color",oe(i[0])),y(e,"class","popup svelte-1jih2az")},m(a,f){w(a,e,f),I(e,s),I(s,r),t=!0},p(a,[f]){(!t||f&1)&&l!==(l=ae(a[0])+"")&&O(r,l),(!t||f&1)&&le(s,"color",oe(a[0]))},i(a){t||(a&&ee(()=>{t&&(n||(n=ie(e,fe,{},!0)),n.run(1))}),t=!0)},o(a){a&&(n||(n=ie(e,fe,{},!1)),n.run(0)),t=!1},d(a){a&&_(e),a&&n&&n.end()}}}function Je(i,e,s){const l=De();let{stage:r}=e;return setTimeout(()=>{l("hide")},2e3),i.$$set=t=>{"stage"in t&&s(0,r=t.stage)},[r]}class Be extends te{constructor(e){super(),se(this,e,Je,Fe,x,{stage:0})}}function ue(i){let e,s="No sentences to review",l,r,n="Try adding some sentences to the deck or select a different deck",t,a,f=`<a href="${`${Pe}/decks`}">Manage Decks</a>`;return{c(){e=E("h1"),e.textContent=s,l=M(),r=E("p"),r.textContent=n,t=M(),a=E("p"),a.innerHTML=f,this.h()},l(c){e=D(c,"H1",{class:!0,"data-svelte-h":!0}),q(e)!=="svelte-1bxwpcq"&&(e.textContent=s),l=N(c),r=D(c,"P",{class:!0,"data-svelte-h":!0}),q(r)!=="svelte-eiv2gi"&&(r.textContent=n),t=N(c),a=D(c,"P",{"data-svelte-h":!0}),q(a)!=="svelte-19nwu32"&&(a.innerHTML=f),this.h()},h(){y(e,"class","svelte-nhusw3"),y(r,"class","centered svelte-nhusw3")},m(c,o){w(c,e,o),w(c,l,o),w(c,r,o),w(c,t,o),w(c,a,o)},d(c){c&&(_(e),_(l),_(r),_(t),_(a))}}}function he(i){let e,s=i[2].translation+"",l,r,n,t,a=i[2].hint+"",f,c,o,d,m,h,p,u,g,k=i[5]&&de(i),b=i[4]&&_e(i),C=i[3]&&pe(i);return{c(){e=E("h1"),l=T(s),r=M(),n=E("div"),t=E("p"),f=T(a),c=M(),k&&k.c(),o=M(),d=E("div"),m=E("input"),h=M(),b&&b.c(),p=M(),C&&C.c(),u=F(),this.h()},l(v){e=D(v,"H1",{class:!0});var S=A(e);l=j(S,s),S.forEach(_),r=N(v),n=D(v,"DIV",{class:!0});var z=A(n);t=D(z,"P",{});var V=A(t);f=j(V,a),V.forEach(_),z.forEach(_),c=N(v),k&&k.l(v),o=N(v),d=D(v,"DIV",{class:!0});var R=A(d);m=D(R,"INPUT",{type:!0,class:!0}),R.forEach(_),h=N(v),b&&b.l(v),p=N(v),C&&C.l(v),u=F(),this.h()},h(){y(e,"class","svelte-nhusw3"),y(n,"class","hint-container svelte-nhusw3"),y(m,"type","text"),y(m,"class","svelte-nhusw3"),y(d,"class","input-container svelte-nhusw3")},m(v,S){w(v,e,S),I(e,l),w(v,r,S),w(v,n,S),I(n,t),I(t,f),w(v,c,S),k&&k.m(v,S),w(v,o,S),w(v,d,S),I(d,m),i[13](m),w(v,h,S),b&&b.m(v,S),w(v,p,S),C&&C.m(v,S),w(v,u,S),g=!0},p(v,S){(!g||S&4)&&s!==(s=v[2].translation+"")&&O(l,s),(!g||S&4)&&a!==(a=v[2].hint+"")&&O(f,a),v[5]?k?(k.p(v,S),S&32&&L(k,1)):(k=de(v),k.c(),L(k,1),k.m(o.parentNode,o)):k&&(K(),H(k,1,1,()=>{k=null}),Z()),v[4]?b?b.p(v,S):(b=_e(v),b.c(),b.m(p.parentNode,p)):b&&(b.d(1),b=null),v[3]?C?(C.p(v,S),S&8&&L(C,1)):(C=pe(v),C.c(),L(C,1),C.m(u.parentNode,u)):C&&(K(),H(C,1,1,()=>{C=null}),Z())},i(v){g||(L(k),L(C),g=!0)},o(v){H(k),H(C),g=!1},d(v){v&&(_(e),_(r),_(n),_(c),_(o),_(d),_(h),_(p),_(u)),k&&k.d(v),i[13](null),b&&b.d(v),C&&C.d(v)}}}function de(i){let e,s;return e=new Be({props:{stage:i[6]}}),e.$on("hide",i[12]),{c(){U(e.$$.fragment)},l(l){X(e.$$.fragment,l)},m(l,r){Y(e,l,r),s=!0},p(l,r){const n={};r&64&&(n.stage=l[6]),e.$set(n)},i(l){s||(L(e.$$.fragment,l),s=!0)},o(l){H(e.$$.fragment,l),s=!1},d(l){G(e,l)}}}function _e(i){let e,s;return{c(){e=E("div"),s=T(i[4]),this.h()},l(l){e=D(l,"DIV",{class:!0});var r=A(e);s=j(r,i[4]),r.forEach(_),this.h()},h(){y(e,"class","notification svelte-nhusw3")},m(l,r){w(l,e,r),I(e,s)},p(l,r){r&16&&O(s,l[4])},d(l){l&&_(e)}}}function pe(i){let e,s,l,r,n,t,a,f,c,o=i[7]?"Correct!":"Incorrect",d,m,h;s=new ce({props:{readings:i[1],furigana:[],colors:i[9]}}),n=new ce({props:{readings:i[2].reading,furigana:i[2].furigana,colors:i[8]}});let p=i[2].note&&me(i);return{c(){e=E("div"),U(s.$$.fragment),l=M(),r=E("div"),U(n.$$.fragment),t=M(),p&&p.c(),a=M(),f=E("div"),c=E("h2"),d=T(o),this.h()},l(u){e=D(u,"DIV",{class:!0});var g=A(e);X(s.$$.fragment,g),g.forEach(_),l=N(u),r=D(u,"DIV",{class:!0});var k=A(r);X(n.$$.fragment,k),k.forEach(_),t=N(u),p&&p.l(u),a=N(u),f=D(u,"DIV",{class:!0});var b=A(f);c=D(b,"H2",{class:!0});var C=A(c);d=j(C,o),C.forEach(_),b.forEach(_),this.h()},h(){y(e,"class","sentence-container svelte-nhusw3"),y(r,"class","sentence-container svelte-nhusw3"),y(c,"class",m=ne(i[7]?"correct":"incorrect")+" svelte-nhusw3"),y(f,"class","result-container svelte-nhusw3")},m(u,g){w(u,e,g),Y(s,e,null),w(u,l,g),w(u,r,g),Y(n,r,null),w(u,t,g),p&&p.m(u,g),w(u,a,g),w(u,f,g),I(f,c),I(c,d),h=!0},p(u,g){const k={};g&2&&(k.readings=u[1]),g&512&&(k.colors=u[9]),s.$set(k);const b={};g&4&&(b.readings=u[2].reading),g&4&&(b.furigana=u[2].furigana),g&256&&(b.colors=u[8]),n.$set(b),u[2].note?p?p.p(u,g):(p=me(u),p.c(),p.m(a.parentNode,a)):p&&(p.d(1),p=null),(!h||g&128)&&o!==(o=u[7]?"Correct!":"Incorrect")&&O(d,o),(!h||g&128&&m!==(m=ne(u[7]?"correct":"incorrect")+" svelte-nhusw3"))&&y(c,"class",m)},i(u){h||(L(s.$$.fragment,u),L(n.$$.fragment,u),h=!0)},o(u){H(s.$$.fragment,u),H(n.$$.fragment,u),h=!1},d(u){u&&(_(e),_(l),_(r),_(t),_(a),_(f)),G(s),G(n),p&&p.d(u)}}}function me(i){let e,s,l=i[2].note+"",r;return{c(){e=E("div"),s=E("p"),r=T(l),this.h()},l(n){e=D(n,"DIV",{class:!0});var t=A(e);s=D(t,"P",{});var a=A(s);r=j(a,l),a.forEach(_),t.forEach(_),this.h()},h(){y(e,"class","note-container svelte-nhusw3")},m(n,t){w(n,e,t),I(e,s),I(s,r)},p(n,t){t&4&&l!==(l=n[2].note+"")&&O(r,l)},d(n){n&&_(e)}}}function Ke(i){let e,s,l,r=i[2]===null&&ue(),n=i[2]&&he(i);return{c(){r&&r.c(),e=M(),n&&n.c(),s=F()},l(t){r&&r.l(t),e=N(t),n&&n.l(t),s=F()},m(t,a){r&&r.m(t,a),w(t,e,a),n&&n.m(t,a),w(t,s,a),l=!0},p(t,[a]){t[2]===null?r||(r=ue(),r.c(),r.m(e.parentNode,e)):r&&(r.d(1),r=null),t[2]?n?(n.p(t,a),a&4&&L(n,1)):(n=he(t),n.c(),L(n,1),n.m(s.parentNode,s)):n&&(K(),H(n,1,1,()=>{n=null}),Z())},i(t){l||(L(n),l=!0)},o(t){H(n),l=!1},d(t){t&&(_(e),_(s)),r&&r.d(t),n&&n.d(t)}}}function Ze(i,e,s){let l,r,n,t,a,{selectedDeck:f=null}=e;const c=De();let o,d="",m=!1,h=!1,p="",u=!1,g,k=!1;const b=()=>{if(l.length>0){if(l=f?$(f):[],console.log("Number of sentences: "+l.length),l.length===0){s(2,V=null);return}s(2,V=l[Math.floor(Math.random()*l.length)])}S()},C=()=>{s(1,d=""),s(0,o.value="",o),s(3,m=!1)},v=()=>{s(3,m=!0);const P=V==null?void 0:V.srs;if(P&&!k){const W=He(P,a);s(6,g=W.stage),s(5,u=!0),c("srs",{sentence:V,srs:W})}},S=()=>{o&&o.focus()},z=P=>{if(P===""){h=!0,s(4,p="Input cannot be empty!");return}h=/[a-zA-Z0-9]/.test(P),s(4,p=h?"Invalid characters in input!":"")};let V=null;Ie(()=>{b(),window.addEventListener("keydown",P=>{if(P.key==="Enter"){if(z(d),h)return;f&&V&&m?(C(),b()):v()}})});const R=()=>s(5,u=!1);function Le(P){Se[P?"unshift":"push"](()=>{o=P,s(0,o)})}return i.$$set=P=>{"selectedDeck"in P&&s(10,f=P.selectedDeck)},i.$$.update=()=>{i.$$.dirty&1024&&(l=f?$(f):[]),i.$$.dirty&1024&&f&&b(),i.$$.dirty&4&&V&&(k=!1),i.$$.dirty&1&&o&&(s(0,o.value="",o),o&&Te(o),o.addEventListener("input",P=>{s(1,d=Oe(P.target.value))}),S()),i.$$.dirty&6&&s(11,r=V&&ze(V,d)),i.$$.dirty&2048&&s(9,n=r&&r.answerCorrectness.map(P=>P?"#94f77e":"#f25f44")),i.$$.dirty&2048&&s(8,t=r&&r.readingCorrectness.map(P=>P?"#94f77e":"#f25f44")),i.$$.dirty&2048&&s(7,a=r?r.isCorrect:!1)},[o,d,V,m,p,u,g,a,t,n,f,r,R,Le]}class Ue extends te{constructor(e){super(),se(this,e,Ze,Ke,x,{selectedDeck:10})}}function ve(i,e,s){const l=i.slice();return l[11]=e[s],l[13]=s,l}function ge(i,e,s){const l=i.slice();return l[11]=e[s],l[13]=s,l}function ke(i){let e,s,l="Choose a deck:",r,n,t,a,f=`<a href="${`${Pe}/decks`}">Manage Decks</a>`,c,o,d=Q(i[0]),m=[];for(let h=0;h<d.length;h+=1)m[h]=we(ge(i,d,h));return{c(){e=E("form"),s=E("label"),s.textContent=l,r=M(),n=E("select");for(let h=0;h<m.length;h+=1)m[h].c();t=M(),a=E("p"),a.innerHTML=f,this.h()},l(h){e=D(h,"FORM",{});var p=A(e);s=D(p,"LABEL",{for:!0,"data-svelte-h":!0}),q(s)!=="svelte-smnxxd"&&(s.textContent=l),r=N(p),n=D(p,"SELECT",{name:!0,id:!0});var u=A(n);for(let g=0;g<m.length;g+=1)m[g].l(u);u.forEach(_),p.forEach(_),t=N(h),a=D(h,"P",{"data-svelte-h":!0}),q(a)!=="svelte-19nwu32"&&(a.innerHTML=f),this.h()},h(){y(s,"for","decks"),y(n,"name","decks"),y(n,"id","decks"),i[1]===void 0&&ee(()=>i[6].call(n))},m(h,p){w(h,e,p),I(e,s),I(e,r),I(e,n);for(let u=0;u<m.length;u+=1)m[u]&&m[u].m(n,null);J(n,i[1],!0),w(h,t,p),w(h,a,p),c||(o=ye(n,"change",i[6]),c=!0)},p(h,p){if(p&17){d=Q(h[0]);let u;for(u=0;u<d.length;u+=1){const g=ge(h,d,u);m[u]?m[u].p(g,p):(m[u]=we(g),m[u].c(),m[u].m(n,null))}for(;u<m.length;u+=1)m[u].d(1);m.length=d.length}p&3&&J(n,h[1])},d(h){h&&(_(e),_(t),_(a)),Ae(m,h),c=!1,o()}}}function we(i){let e,s=i[11].name+"",l,r,n=i[4][i[13]]+"",t,a,f;return{c(){e=E("option"),l=T(s),r=T(" ("),t=T(n),a=T(")"),this.h()},l(c){e=D(c,"OPTION",{});var o=A(e);l=j(o,s),r=j(o," ("),t=j(o,n),a=j(o,")"),o.forEach(_),this.h()},h(){e.__value=f=i[11],B(e,e.__value)},m(c,o){w(c,e,o),I(e,l),I(e,r),I(e,t),I(e,a)},p(c,o){o&1&&s!==(s=c[11].name+"")&&O(l,s),o&16&&n!==(n=c[4][c[13]]+"")&&O(t,n),o&1&&f!==(f=c[11])&&(e.__value=f,B(e,e.__value))},d(c){c&&_(e)}}}function be(i){let e,s,l="Choose a deck",r,n,t,a,f,c=Q(i[0]),o=[];for(let d=0;d<c.length;d+=1)o[d]=Ce(ve(i,c,d));return{c(){e=E("div"),s=E("h1"),s.textContent=l,r=M(),n=E("form"),t=E("select");for(let d=0;d<o.length;d+=1)o[d].c();this.h()},l(d){e=D(d,"DIV",{class:!0});var m=A(e);s=D(m,"H1",{class:!0,"data-svelte-h":!0}),q(s)!=="svelte-1mswgjr"&&(s.textContent=l),r=N(m),n=D(m,"FORM",{});var h=A(n);t=D(h,"SELECT",{name:!0,id:!0,class:!0});var p=A(t);for(let u=0;u<o.length;u+=1)o[u].l(p);p.forEach(_),h.forEach(_),m.forEach(_),this.h()},h(){y(s,"class","svelte-zcy7mq"),y(t,"name","decks"),y(t,"id","decks"),y(t,"class","svelte-zcy7mq"),i[1]===void 0&&ee(()=>i[7].call(t)),y(e,"class","pick-decks-container svelte-zcy7mq")},m(d,m){w(d,e,m),I(e,s),I(e,r),I(e,n),I(n,t);for(let h=0;h<o.length;h+=1)o[h]&&o[h].m(t,null);J(t,i[1],!0),a||(f=ye(t,"change",i[7]),a=!0)},p(d,m){if(m&17){c=Q(d[0]);let h;for(h=0;h<c.length;h+=1){const p=ve(d,c,h);o[h]?o[h].p(p,m):(o[h]=Ce(p),o[h].c(),o[h].m(t,null))}for(;h<o.length;h+=1)o[h].d(1);o.length=c.length}m&3&&J(t,d[1])},d(d){d&&_(e),Ae(o,d),a=!1,f()}}}function Ce(i){let e,s=i[11].name+"",l,r,n=i[4][i[13]]+"",t,a,f;return{c(){e=E("option"),l=T(s),r=T(" ("),t=T(n),a=T(")"),this.h()},l(c){e=D(c,"OPTION",{});var o=A(e);l=j(o,s),r=j(o," ("),t=j(o,n),a=j(o,")"),o.forEach(_),this.h()},h(){e.__value=f=i[11],B(e,e.__value)},m(c,o){w(c,e,o),I(e,l),I(e,r),I(e,t),I(e,a)},p(c,o){o&1&&s!==(s=c[11].name+"")&&O(l,s),o&16&&n!==(n=c[4][c[13]]+"")&&O(t,n),o&1&&f!==(f=c[11])&&(e.__value=f,B(e,e.__value))},d(c){c&&_(e)}}}function Ee(i){let e,s,l;function r(t){i[8](t)}let n={};return i[1]!==void 0&&(n.selectedDeck=i[1]),e=new Ue({props:n}),Se.push(()=>Ve(e,"selectedDeck",r)),e.$on("srs",i[9]),{c(){U(e.$$.fragment)},l(t){X(e.$$.fragment,t)},m(t,a){Y(e,t,a),l=!0},p(t,a){const f={};!s&&a&2&&(s=!0,f.selectedDeck=t[1],Ne(()=>s=!1)),e.$set(f)},i(t){l||(L(e.$$.fragment,t),l=!0)},o(t){H(e.$$.fragment,t),l=!1},d(t){G(e,t)}}}function Xe(i){let e,s,l,r,n,t=i[2]&&ke(i),a=i[3]&&be(i),f=i[2]&&Ee(i);return{c(){e=E("div"),t&&t.c(),s=M(),l=E("div"),a&&a.c(),r=M(),f&&f.c(),this.h()},l(c){e=D(c,"DIV",{class:!0});var o=A(e);t&&t.l(o),s=N(o),l=D(o,"DIV",{class:!0});var d=A(l);a&&a.l(d),r=N(d),f&&f.l(d),d.forEach(_),o.forEach(_),this.h()},h(){y(l,"class","container svelte-zcy7mq"),y(e,"class","page")},m(c,o){w(c,e,o),t&&t.m(e,null),I(e,s),I(e,l),a&&a.m(l,null),I(l,r),f&&f.m(l,null),n=!0},p(c,[o]){c[2]?t?t.p(c,o):(t=ke(c),t.c(),t.m(e,s)):t&&(t.d(1),t=null),c[3]?a?a.p(c,o):(a=be(c),a.c(),a.m(l,r)):a&&(a.d(1),a=null),c[2]?f?(f.p(c,o),o&4&&L(f,1)):(f=Ee(c),f.c(),L(f,1),f.m(l,null)):f&&(K(),H(f,1,1,()=>{f=null}),Z())},i(c){n||(L(f),n=!0)},o(c){H(f),n=!1},d(c){c&&_(e),t&&t.d(),a&&a.d(),f&&f.d()}}}function Ye(i,e,s){let l,r,n,t=[],a;const f=(h,p)=>{const u=a,g=h,k=t.findIndex(C=>C===u),b=u.sentences.findIndex(C=>C===g);k!==-1&&b!==-1&&(u.sentences[b]={...g,srs:p},console.log("Saving deck"),s(0,t[k]=u,t)),localStorage.setItem("decks",JSON.stringify(t))};Ie(()=>{const h=localStorage.getItem("decks");h&&s(0,t=JSON.parse(h)),(!h||t.length==0)&&s(0,t=[{name:"Default Deck",description:"This is a default deck",sentences:[qe]}])});function c(){a=re(this),s(1,a),s(0,t)}function o(){a=re(this),s(1,a),s(0,t)}function d(h){a=h,s(1,a)}const m=h=>{f(h.detail.sentence,h.detail.srs)};return i.$$.update=()=>{i.$$.dirty&1&&s(4,l=t.map(h=>$(h).length)),i.$$.dirty&1&&t.length,i.$$.dirty&3&&s(3,r=t.length>0&&a===null),i.$$.dirty&2&&s(2,n=a!==null)},[t,a,n,r,l,f,c,o,d,m]}class et extends te{constructor(e){super(),se(this,e,Ye,Xe,x,{})}}export{et as component};
