import{s as ve,e as k,t as F,d as p,f as S,h as Y,i as _,w as Pe,k as K,l as c,m as oe,n as ce,v as E,T as Se,b as N,j,U as te,Y as ee,W,C as qe,r as Be,x as we,E as at,V as Xe,X as rt,_ as it,Z as De}from"../chunks/scheduler.BGfZ2OPz.js";import{S as _e,i as ge,g as fe,a as H,c as he,t as O,b as se,d as le,m as ae,e as re,h as Te}from"../chunks/index.CBGtRaXf.js";import{s as je,a as ze,S as ot,e as Ee,N as Ve,u as nt,o as ct,C as st,g as Ce,h as ut,d as Fe,i as lt,j as dt,k as ft,l as ht,f as vt}from"../chunks/crud.3eonXhL3.js";import{b as _t}from"../chunks/paths.BpLXwe-_.js";function gt(l){let e,t=je(l[0])+"",s;return{c(){e=k("p"),s=F(t),this.h()},l(r){e=p(r,"P",{style:!0});var n=S(e);s=Y(n,t),n.forEach(_),this.h()},h(){Pe(e,"color",ze(l[0]))},m(r,n){K(r,e,n),c(e,s)},p(r,[n]){n&1&&t!==(t=je(r[0])+"")&&oe(s,t),n&1&&Pe(e,"color",ze(r[0]))},i:ce,o:ce,d(r){r&&_(e)}}}function kt(l,e,t){let{stage:s}=e,{srs:r}=e;return l.$$set=n=>{"stage"in n&&t(0,s=n.stage),"srs"in n&&t(1,r=n.srs)},[s,r]}class pt extends _e{constructor(e){super(),ge(this,e,kt,gt,ve,{stage:0,srs:1})}}function Ye(l,e,t){const s=l.slice();return s[12]=e[t],s}function mt(l){let e,t,s,r,n,a,o,i='<tr><th class="svelte-al4gev">Translation</th> <th class="svelte-al4gev">Sentence</th> <th class="svelte-al4gev">Notes</th> <th class="svelte-al4gev">Hint</th> <th class="svelte-al4gev">Stage</th> <th class="svelte-al4gev">Review</th> <th class="svelte-al4gev">Actions</th></tr>',d,v,f=[],T=new Map,C,D,w="Add Sentence",$,R,m,g,u,A=Ee(l[3]);const P=h=>h[12].id;for(let h=0;h<A.length;h+=1){let b=Ye(l,A,h),M=P(b);T.set(M,f[h]=We(M,b))}return R=new Ve({props:{view:[{to:"cancel",label:"Cancel",active:!0},{to:"save",label:"Save",active:!0}]}}),R.$on("navigate",l[11]),{c(){e=k("div"),t=k("input"),s=N(),r=k("textarea"),n=N(),a=k("table"),o=k("thead"),o.innerHTML=i,d=N(),v=k("tbody");for(let h=0;h<f.length;h+=1)f[h].c();C=N(),D=k("button"),D.textContent=w,$=N(),se(R.$$.fragment),this.h()},l(h){e=p(h,"DIV",{class:!0});var b=S(e);t=p(b,"INPUT",{placeholder:!0,class:!0}),s=j(b),r=p(b,"TEXTAREA",{placeholder:!0,class:!0}),S(r).forEach(_),b.forEach(_),n=j(h),a=p(h,"TABLE",{class:!0});var M=S(a);o=p(M,"THEAD",{"data-svelte-h":!0}),te(o)!=="svelte-8zpm6h"&&(o.innerHTML=i),d=j(M),v=p(M,"TBODY",{});var U=S(v);for(let L=0;L<f.length;L+=1)f[L].l(U);U.forEach(_),M.forEach(_),C=j(h),D=p(h,"BUTTON",{class:!0,"data-svelte-h":!0}),te(D)!=="svelte-1f1ee0k"&&(D.textContent=w),$=j(h),le(R.$$.fragment,h),this.h()},h(){E(t,"placeholder","Deck Name"),E(t,"class","svelte-al4gev"),E(r,"placeholder","Deck Description"),E(r,"class","svelte-al4gev"),E(e,"class","deck-info svelte-al4gev"),E(a,"class","sentence-table svelte-al4gev"),E(D,"class","primary add-sentence svelte-al4gev")},m(h,b){K(h,e,b),c(e,t),ee(t,l[1]),c(e,s),c(e,r),ee(r,l[2]),K(h,n,b),K(h,a,b),c(a,o),c(a,d),c(a,v);for(let M=0;M<f.length;M+=1)f[M]&&f[M].m(v,null);K(h,C,b),K(h,D,b),K(h,$,b),ae(R,h,b),m=!0,g||(u=[W(t,"input",l[8]),W(r,"input",l[9]),W(D,"click",l[6])],g=!0)},p(h,b){b&2&&t.value!==h[1]&&ee(t,h[1]),b&4&&ee(r,h[2]),b&25&&(A=Ee(h[3]),fe(),f=nt(f,b,P,1,h,A,T,v,ct,We,null,Ye),he())},i(h){if(!m){for(let b=0;b<A.length;b+=1)O(f[b]);O(R.$$.fragment,h),m=!0}},o(h){for(let b=0;b<f.length;b+=1)H(f[b]);H(R.$$.fragment,h),m=!1},d(h){h&&(_(e),_(n),_(a),_(C),_(D),_($));for(let b=0;b<f.length;b+=1)f[b].d();re(R,h),g=!1,qe(u)}}}function bt(l){let e,t="Deck not found";return{c(){e=k("p"),e.textContent=t},l(s){e=p(s,"P",{"data-svelte-h":!0}),te(e)!=="svelte-vs2gpw"&&(e.textContent=t)},m(s,r){K(s,e,r)},p:ce,i:ce,o:ce,d(s){s&&_(e)}}}function Je(l){let e,t;return e=new pt({props:{stage:l[12].srs.stage,srs:l[12].srs}}),{c(){se(e.$$.fragment)},l(s){le(e.$$.fragment,s)},m(s,r){ae(e,s,r),t=!0},p(s,r){const n={};r&8&&(n.stage=s[12].srs.stage),r&8&&(n.srs=s[12].srs),e.$set(n)},i(s){t||(O(e.$$.fragment,s),t=!0)},o(s){H(e.$$.fragment,s),t=!1},d(s){re(e,s)}}}function Ke(l){let e=Ce(l[12].srs)+"",t;return{c(){t=F(e)},l(s){t=Y(s,e)},m(s,r){K(s,t,r)},p(s,r){r&8&&e!==(e=Ce(s[12].srs)+"")&&oe(t,e)},d(s){s&&_(t)}}}function We(l,e){let t,s,r=e[12].translation+"",n,a,o,i,d,v,f=e[12].note+"",T,C,D,w=e[12].hint+"",$,R,m,g,u,A,P,h,b="Edit",M,U,L,Z;i=new st({props:{readings:e[12].reading,furigana:e[12].furigana,colors:e[12].optional.map(Ze)}});let B=e[12].srs&&Je(e),V=e[12].srs&&Ke(e);function ke(){return e[10](e[12])}return{key:l,first:null,c(){t=k("tr"),s=k("td"),n=F(r),a=N(),o=k("td"),se(i.$$.fragment),d=N(),v=k("td"),T=F(f),C=N(),D=k("td"),$=F(w),R=N(),m=k("td"),B&&B.c(),g=N(),u=k("td"),V&&V.c(),A=N(),P=k("td"),h=k("button"),h.textContent=b,M=N(),this.h()},l(X){t=p(X,"TR",{});var q=S(t);s=p(q,"TD",{class:!0});var Q=S(s);n=Y(Q,r),Q.forEach(_),a=j(q),o=p(q,"TD",{class:!0});var ne=S(o);le(i.$$.fragment,ne),ne.forEach(_),d=j(q),v=p(q,"TD",{class:!0});var ue=S(v);T=Y(ue,f),ue.forEach(_),C=j(q),D=p(q,"TD",{class:!0});var y=S(D);$=Y(y,w),y.forEach(_),R=j(q),m=p(q,"TD",{class:!0});var pe=S(m);B&&B.l(pe),pe.forEach(_),g=j(q),u=p(q,"TD",{class:!0});var de=S(u);V&&V.l(de),de.forEach(_),A=j(q),P=p(q,"TD",{class:!0});var x=S(P);h=p(x,"BUTTON",{class:!0,"data-svelte-h":!0}),te(h)!=="svelte-dkigzt"&&(h.textContent=b),x.forEach(_),M=j(q),q.forEach(_),this.h()},h(){E(s,"class","svelte-al4gev"),E(o,"class","reading svelte-al4gev"),E(v,"class","svelte-al4gev"),E(D,"class","svelte-al4gev"),E(m,"class","srs-container svelte-al4gev"),E(u,"class","svelte-al4gev"),E(h,"class","primary svelte-al4gev"),E(P,"class","svelte-al4gev"),this.first=t},m(X,q){K(X,t,q),c(t,s),c(s,n),c(t,a),c(t,o),ae(i,o,null),c(t,d),c(t,v),c(v,T),c(t,C),c(t,D),c(D,$),c(t,R),c(t,m),B&&B.m(m,null),c(t,g),c(t,u),V&&V.m(u,null),c(t,A),c(t,P),c(P,h),c(t,M),U=!0,L||(Z=W(h,"click",ke),L=!0)},p(X,q){e=X,(!U||q&8)&&r!==(r=e[12].translation+"")&&oe(n,r);const Q={};q&8&&(Q.readings=e[12].reading),q&8&&(Q.furigana=e[12].furigana),q&8&&(Q.colors=e[12].optional.map(Ze)),i.$set(Q),(!U||q&8)&&f!==(f=e[12].note+"")&&oe(T,f),(!U||q&8)&&w!==(w=e[12].hint+"")&&oe($,w),e[12].srs?B?(B.p(e,q),q&8&&O(B,1)):(B=Je(e),B.c(),O(B,1),B.m(m,null)):B&&(fe(),H(B,1,1,()=>{B=null}),he()),e[12].srs?V?V.p(e,q):(V=Ke(e),V.c(),V.m(u,null)):V&&(V.d(1),V=null)},i(X){U||(O(i.$$.fragment,X),O(B),U=!0)},o(X){H(i.$$.fragment,X),H(B),U=!1},d(X){X&&_(t),re(i),B&&B.d(),V&&V.d(),L=!1,Z()}}}function wt(l){let e,t,s,r;const n=[bt,mt],a=[];function o(i,d){return i[0]?1:0}return t=o(l),s=a[t]=n[t](l),{c(){e=k("div"),s.c(),this.h()},l(i){e=p(i,"DIV",{class:!0});var d=S(e);s.l(d),d.forEach(_),this.h()},h(){E(e,"class","container svelte-al4gev")},m(i,d){K(i,e,d),a[t].m(e,null),r=!0},p(i,[d]){let v=t;t=o(i),t===v?a[t].p(i,d):(fe(),H(a[v],1,1,()=>{a[v]=null}),he(),s=a[t],s?s.p(i,d):(s=a[t]=n[t](i),s.c()),O(s,1),s.m(e,null))},i(i){r||(O(s),r=!0)},o(i){H(s),r=!1},d(i){i&&_(e),a[t].d()}}}const Ze=l=>l?"blue":"black";function Et(l,e,t){let s;const r=Se();let{deckMetadata:n}=e,{storage:a}=e,o=n.name,i=n.description;function d(){t(0,n.name=o,n),t(0,n.description=i,n),a.addOrUpdateDeck(n),r("navigate",{to:"decks"})}function v(){const $={id:Math.random().toString(36).substring(7),furigana:[],hint:"",note:"",optional:[],optionalCluster:[],raw:"",reading:[],srs:{stage:ot.Apprentice1,nextReview:new Date,lastReview:new Date,streak:0,maxStreak:0},translation:""};r("edit",{deck:n,sentence:$})}function f(){o=this.value,t(1,o)}function T(){i=this.value,t(2,i)}const C=w=>r("edit",{deck:n,sentence:w}),D=w=>w.detail.to==="save"?d():r("cancel");return l.$$set=w=>{"deckMetadata"in w&&t(0,n=w.deckMetadata),"storage"in w&&t(7,a=w.storage)},l.$$.update=()=>{l.$$.dirty&129&&t(3,s=n&&a&&a.getSentencesForDeck(n.id))},[n,o,i,s,r,d,v,a,f,T,C,D]}class Dt extends _e{constructor(e){super(),ge(this,e,Et,wt,ve,{deckMetadata:0,storage:7})}}function Ge(l,e,t){const s=l.slice();return s[8]=e[t],s}function Qe(l,e){let t,s,r=e[8].name+"",n,a,o=e[8].sentenceIds.length+"",i,d,v,f,T=e[8].description+"",C,D,w,$,R="Edit",m,g,u="Delete",A,P,h;function b(){return e[5](e[8])}function M(){return e[6](e[8])}return{key:l,first:null,c(){t=k("div"),s=k("h2"),n=F(r),a=F(" ("),i=F(o),d=F(")"),v=N(),f=k("p"),C=F(T),D=N(),w=k("div"),$=k("button"),$.textContent=R,m=N(),g=k("button"),g.textContent=u,A=N(),this.h()},l(U){t=p(U,"DIV",{class:!0});var L=S(t);s=p(L,"H2",{class:!0});var Z=S(s);n=Y(Z,r),a=Y(Z," ("),i=Y(Z,o),d=Y(Z,")"),Z.forEach(_),v=j(L),f=p(L,"P",{});var B=S(f);C=Y(B,T),B.forEach(_),D=j(L),w=p(L,"DIV",{class:!0});var V=S(w);$=p(V,"BUTTON",{class:!0,"data-svelte-h":!0}),te($)!=="svelte-xkyu9k"&&($.textContent=R),m=j(V),g=p(V,"BUTTON",{class:!0,"data-svelte-h":!0}),te(g)!=="svelte-1v25wbx"&&(g.textContent=u),V.forEach(_),A=j(L),L.forEach(_),this.h()},h(){E(s,"class","svelte-1jx2618"),E($,"class","edit-button svelte-1jx2618"),E(g,"class","delete-button svelte-1jx2618"),E(w,"class","deck-actions svelte-1jx2618"),E(t,"class","deck-card svelte-1jx2618"),this.first=t},m(U,L){K(U,t,L),c(t,s),c(s,n),c(s,a),c(s,i),c(s,d),c(t,v),c(t,f),c(f,C),c(t,D),c(t,w),c(w,$),c(w,m),c(w,g),c(t,A),P||(h=[W($,"click",b),W(g,"click",M)],P=!0)},p(U,L){e=U,L&1&&r!==(r=e[8].name+"")&&oe(n,r),L&1&&o!==(o=e[8].sentenceIds.length+"")&&oe(i,o),L&1&&T!==(T=e[8].description+"")&&oe(C,T)},d(U){U&&_(t),P=!1,qe(h)}}}function Tt(l){let e,t,s="Decks",r,n,a=[],o=new Map,i,d,v="Add Deck",f,T,C,D,w,$=Ee(l[0]);const R=m=>m[8].id;for(let m=0;m<$.length;m+=1){let g=Ge(l,$,m),u=R(g);o.set(u,a[m]=Qe(u,g))}return T=new Ve({props:{view:[{to:"review",label:"Review",active:!0},{to:"decks",label:"Edit Decks",active:!1}]}}),T.$on("navigate",l[7]),{c(){e=k("div"),t=k("h1"),t.textContent=s,r=N(),n=k("div");for(let m=0;m<a.length;m+=1)a[m].c();i=N(),d=k("button"),d.textContent=v,f=N(),se(T.$$.fragment),this.h()},l(m){e=p(m,"DIV",{class:!0});var g=S(e);t=p(g,"H1",{"data-svelte-h":!0}),te(t)!=="svelte-1txjx0s"&&(t.textContent=s),r=j(g),n=p(g,"DIV",{class:!0});var u=S(n);for(let A=0;A<a.length;A+=1)a[A].l(u);u.forEach(_),i=j(g),d=p(g,"BUTTON",{class:!0,"data-svelte-h":!0}),te(d)!=="svelte-2g2ez9"&&(d.textContent=v),f=j(g),le(T.$$.fragment,g),g.forEach(_),this.h()},h(){E(n,"class","deck-list svelte-1jx2618"),E(d,"class","add-deck-button svelte-1jx2618"),E(e,"class","decks-view svelte-1jx2618")},m(m,g){K(m,e,g),c(e,t),c(e,r),c(e,n);for(let u=0;u<a.length;u+=1)a[u]&&a[u].m(n,null);c(e,i),c(e,d),c(e,f),ae(T,e,null),C=!0,D||(w=W(d,"click",l[2]),D=!0)},p(m,[g]){g&11&&($=Ee(m[0]),a=nt(a,g,R,1,m,$,o,n,ut,Qe,null,Ge))},i(m){C||(O(T.$$.fragment,m),C=!0)},o(m){H(T.$$.fragment,m),C=!1},d(m){m&&_(e);for(let g=0;g<a.length;g+=1)a[g].d();re(T),D=!1,w()}}}function Ct(l,e,t){const s=Se();let{decks:r=[]}=e,{storage:n}=e;function a(){const f=prompt("Enter the name of the deck"),T=prompt("Enter the description of the deck");if(f&&T){const D={id:Math.random().toString(36).substring(7),name:f,description:T,sentenceIds:[]};n.addDeck(D),t(0,r=n.getDecks())}}function o(f){confirm("Are you sure you want to delete this deck?")&&(n.deleteDeck(f),t(0,r=n.getDecks()))}Be(()=>{});const i=f=>s("edit",{deck:f}),d=f=>o(f.id),v=f=>s("navigate",{to:f.detail.to});return l.$$set=f=>{"decks"in f&&t(0,r=f.decks),"storage"in f&&t(4,n=f.storage)},[r,s,a,o,n,i,d,v]}class St extends _e{constructor(e){super(),ge(this,e,Ct,Tt,ve,{decks:0,storage:4})}}function At(l){let e;return{c(){e=k("textarea"),this.h()},l(t){e=p(t,"TEXTAREA",{class:!0}),S(e).forEach(_),this.h()},h(){e.value=l[0],E(e,"class","svelte-lhjhtv")},m(t,s){K(t,e,s),l[2](e)},p(t,[s]){s&1&&(e.value=t[0])},i:ce,o:ce,d(t){t&&_(e),l[2](null)}}}function It(l,e,t){const s=Se();let{value:r}=e,n;Be(()=>{Fe(n),n.addEventListener("input",o=>{t(0,r=o.target.value)}),t(1,n.value=r,n)});function a(o){we[o?"unshift":"push"](()=>{n=o,t(1,n)})}return l.$$set=o=>{"value"in o&&t(0,r=o.value)},l.$$.update=()=>{l.$$.dirty&2&&n&&(n&&Fe(n),n.addEventListener("input",o=>{t(0,r=o.target.value)})),l.$$.dirty&1&&r&&s("input",r)},[r,n,a]}class $t extends _e{constructor(e){super(),ge(this,e,It,At,ve,{value:0})}}function Lt(l,e,t){const s=l.slice();return s[17]=e[t],s}function Rt(l){let e,t=je(l[17])+"",s;return{c(){e=k("option"),s=F(t),this.h()},l(r){e=p(r,"OPTION",{});var n=S(e);s=Y(n,t),n.forEach(_),this.h()},h(){e.__value=l[17],ee(e,e.__value)},m(r,n){K(r,e,n),c(e,s)},p:ce,d(r){r&&_(e)}}}function Mt(l){let e,t,s="Edit Sentence",r,n,a,o,i,d,v,f,T,C,D,w,$,R,m,g,u,A,P,h,b,M,U,L,Z,B=Ce(l[0].srs)+"",V,ke,X,q="Reset SRS",Q,ne,ue,y,pe="Delete Sentence",de,x,me,Ae,Oe;a=new $t({props:{value:l[0].raw}}),a.$on("input",l[8]),i=new st({props:{readings:l[0].reading,furigana:l[0].furigana,colors:l[0].optional.map(ye)}});let Ue=Ee(lt),ie=[];for(let I=0;I<Ue.length;I+=1)ie[I]=Rt(Lt(l,Ue,I));return x=new Ve({props:{view:[{to:"cancel",label:"Cancel",active:!0},{to:"save",label:"Save",active:!0}]}}),x.$on("navigate",l[16]),{c(){e=k("div"),t=k("h1"),t.textContent=s,r=N(),n=k("div"),se(a.$$.fragment),o=N(),se(i.$$.fragment),d=N(),v=k("div"),f=k("label"),T=F(`Translation\r
            `),C=k("input"),D=N(),w=k("label"),$=F(`Notes\r
            `),R=k("textarea"),m=N(),g=k("label"),u=F(`Hint\r
            `),A=k("textarea"),P=N(),h=k("label"),b=F(`SRS Stage\r
            `),M=k("select");for(let I=0;I<ie.length;I+=1)ie[I].c();U=N(),L=k("label"),Z=F("Time until Review: "),V=F(B),ke=N(),X=k("button"),X.textContent=q,Q=N(),ne=k("label"),ue=F(`Delete\r
            `),y=k("button"),y.textContent=pe,de=N(),se(x.$$.fragment),this.h()},l(I){e=p(I,"DIV",{class:!0});var z=S(e);t=p(z,"H1",{"data-svelte-h":!0}),te(t)!=="svelte-x8bscl"&&(t.textContent=s),r=j(z),n=p(z,"DIV",{class:!0});var G=S(n);le(a.$$.fragment,G),o=j(G),le(i.$$.fragment,G),G.forEach(_),d=j(z),v=p(z,"DIV",{class:!0});var J=S(v);f=p(J,"LABEL",{class:!0});var Ie=S(f);T=Y(Ie,`Translation\r
            `),C=p(Ie,"INPUT",{class:!0}),Ie.forEach(_),D=j(J),w=p(J,"LABEL",{class:!0});var $e=S(w);$=Y($e,`Notes\r
            `),R=p($e,"TEXTAREA",{class:!0}),S(R).forEach(_),$e.forEach(_),m=j(J),g=p(J,"LABEL",{class:!0});var Le=S(g);u=Y(Le,`Hint\r
            `),A=p(Le,"TEXTAREA",{class:!0}),S(A).forEach(_),Le.forEach(_),P=j(J),h=p(J,"LABEL",{class:!0});var Re=S(h);b=Y(Re,`SRS Stage\r
            `),M=p(Re,"SELECT",{class:!0});var He=S(M);for(let Ne=0;Ne<ie.length;Ne+=1)ie[Ne].l(He);He.forEach(_),Re.forEach(_),U=j(J),L=p(J,"LABEL",{class:!0});var be=S(L);Z=Y(be,"Time until Review: "),V=Y(be,B),ke=j(be),X=p(be,"BUTTON",{class:!0,"data-svelte-h":!0}),te(X)!=="svelte-1cluvep"&&(X.textContent=q),be.forEach(_),Q=j(J),ne=p(J,"LABEL",{class:!0});var Me=S(ne);ue=Y(Me,`Delete\r
            `),y=p(Me,"BUTTON",{class:!0,"data-svelte-h":!0}),te(y)!=="svelte-1kuu88f"&&(y.textContent=pe),Me.forEach(_),J.forEach(_),de=j(z),le(x.$$.fragment,z),z.forEach(_),this.h()},h(){E(n,"class","sentence-input svelte-6khvqs"),E(C,"class","svelte-6khvqs"),E(f,"class","svelte-6khvqs"),E(R,"class","svelte-6khvqs"),E(w,"class","svelte-6khvqs"),E(A,"class","svelte-6khvqs"),E(g,"class","svelte-6khvqs"),E(M,"class","svelte-6khvqs"),l[0].srs.stage===void 0&&at(()=>l[15].call(M)),E(h,"class","svelte-6khvqs"),E(X,"class","reset-btn svelte-6khvqs"),E(L,"class","svelte-6khvqs"),E(y,"class","reset-btn svelte-6khvqs"),E(ne,"class","svelte-6khvqs"),E(v,"class","form-grid svelte-6khvqs"),E(e,"class","edit-container svelte-6khvqs")},m(I,z){K(I,e,z),c(e,t),c(e,r),c(e,n),ae(a,n,null),c(n,o),ae(i,n,null),c(e,d),c(e,v),c(v,f),c(f,T),c(f,C),ee(C,l[0].translation),c(v,D),c(v,w),c(w,$),c(w,R),ee(R,l[0].note),c(v,m),c(v,g),c(g,u),c(g,A),ee(A,l[0].hint),c(v,P),c(v,h),c(h,b),c(h,M);for(let G=0;G<ie.length;G+=1)ie[G]&&ie[G].m(M,null);Xe(M,l[0].srs.stage,!0),c(v,U),c(v,L),c(L,Z),c(L,V),c(L,ke),c(L,X),c(v,Q),c(v,ne),c(ne,ue),c(ne,y),c(e,de),ae(x,e,null),me=!0,Ae||(Oe=[W(C,"input",l[9]),W(C,"input",l[10]),W(R,"input",l[11]),W(R,"input",l[12]),W(A,"input",l[13]),W(A,"input",l[14]),W(M,"change",l[15]),W(X,"click",l[4]),W(y,"click",l[3])],Ae=!0)},p(I,[z]){const G={};z&1&&(G.value=I[0].raw),a.$set(G);const J={};z&1&&(J.readings=I[0].reading),z&1&&(J.furigana=I[0].furigana),z&1&&(J.colors=I[0].optional.map(ye)),i.$set(J),z&1&&C.value!==I[0].translation&&ee(C,I[0].translation),z&1&&ee(R,I[0].note),z&1&&ee(A,I[0].hint),z&1&&Xe(M,I[0].srs.stage),(!me||z&1)&&B!==(B=Ce(I[0].srs)+"")&&oe(V,B)},i(I){me||(O(a.$$.fragment,I),O(i.$$.fragment,I),O(x.$$.fragment,I),me=!0)},o(I){H(a.$$.fragment,I),H(i.$$.fragment,I),H(x.$$.fragment,I),me=!1},d(I){I&&_(e),re(a),re(i),rt(ie,I),re(x),Ae=!1,qe(Oe)}}}const ye=l=>l?"blue":"black";function Nt(l,e,t){const s=Se();let{deck:r=null}=e,{sentence:n}=e,{storage:a}=e;function o(u,A){if(u==="raw"){const P=A.split("").map(dt).join(""),h=ft(P),{reading:b,furigana:M,optional:U,optionalCluster:L}=ht(h);t(0,n={...n,raw:P,reading:b,furigana:M,optional:U,optionalCluster:L})}else t(0,n={...n,[u]:A})}const i=()=>{confirm("Are you sure you want to delete this sentence?")&&(r&&a.removeSentenceFromDeck(r.id,n.id),a.deleteSentence(n.id),s("cancel"))};function d(){t(0,n.srs={...n.srs,streak:0,maxStreak:0,stage:lt[0],nextReview:new Date},n)}function v(){a.addOrUpdateSentence(n),r&&a.addSentenceToDeck(r.id,n.id),s("edit",{deck:r,sentence:n})}const f=u=>o("raw",u.detail);function T(){n.translation=this.value,t(0,n)}const C=u=>o("translation",u.target.value);function D(){n.note=this.value,t(0,n)}const w=u=>o("note",u.target.value);function $(){n.hint=this.value,t(0,n)}const R=u=>o("hint",u.target.value);function m(){n.srs.stage=it(this),t(0,n)}const g=u=>u.detail.to==="save"?v():s("cancel");return l.$$set=u=>{"deck"in u&&t(6,r=u.deck),"sentence"in u&&t(0,n=u.sentence),"storage"in u&&t(7,a=u.storage)},[n,s,o,i,d,v,r,a,f,T,C,D,w,$,R,m,g]}class jt extends _e{constructor(e){super(),ge(this,e,Nt,Mt,ve,{deck:6,sentence:0,storage:7})}}function xe(l){let e,t,s;function r(a){l[6](a)}let n={storage:l[0]};return l[1]!==void 0&&(n.decks=l[1]),e=new St({props:n}),we.push(()=>Te(e,"decks",r)),e.$on("edit",l[7]),e.$on("navigate",l[8]),{c(){se(e.$$.fragment)},l(a){le(e.$$.fragment,a)},m(a,o){ae(e,a,o),s=!0},p(a,o){const i={};o&1&&(i.storage=a[0]),!t&&o&2&&(t=!0,i.decks=a[1],De(()=>t=!1)),e.$set(i)},i(a){s||(O(e.$$.fragment,a),s=!0)},o(a){H(e.$$.fragment,a),s=!1},d(a){re(e,a)}}}function et(l){let e,t,s;function r(a){l[9](a)}let n={storage:l[0]};return l[2]!==void 0&&(n.deckMetadata=l[2]),e=new Dt({props:n}),we.push(()=>Te(e,"deckMetadata",r)),e.$on("edit",l[10]),e.$on("cancel",l[11]),e.$on("navigate",l[12]),{c(){se(e.$$.fragment)},l(a){le(e.$$.fragment,a)},m(a,o){ae(e,a,o),s=!0},p(a,o){const i={};o&1&&(i.storage=a[0]),!t&&o&4&&(t=!0,i.deckMetadata=a[2],De(()=>t=!1)),e.$set(i)},i(a){s||(O(e.$$.fragment,a),s=!0)},o(a){H(e.$$.fragment,a),s=!1},d(a){re(e,a)}}}function tt(l){let e,t,s,r;function n(i){l[13](i)}function a(i){l[14](i)}let o={storage:l[0]};return l[2]!==void 0&&(o.deck=l[2]),l[3]!==void 0&&(o.sentence=l[3]),e=new jt({props:o}),we.push(()=>Te(e,"deck",n)),we.push(()=>Te(e,"sentence",a)),e.$on("edit",l[15]),e.$on("cancel",l[16]),{c(){se(e.$$.fragment)},l(i){le(e.$$.fragment,i)},m(i,d){ae(e,i,d),r=!0},p(i,d){const v={};d&1&&(v.storage=i[0]),!t&&d&4&&(t=!0,v.deck=i[2],De(()=>t=!1)),!s&&d&8&&(s=!0,v.sentence=i[3],De(()=>s=!1)),e.$set(v)},i(i){r||(O(e.$$.fragment,i),r=!0)},o(i){H(e.$$.fragment,i),r=!1},d(i){re(e,i)}}}function qt(l){let e,t,s,r,n=l[4]==="decks"&&xe(l),a=l[4]==="edit-deck"&&l[2]&&et(l),o=l[4]==="edit-card"&&l[2]&&l[3]&&tt(l);return{c(){e=k("div"),n&&n.c(),t=N(),a&&a.c(),s=N(),o&&o.c(),this.h()},l(i){e=p(i,"DIV",{class:!0});var d=S(e);n&&n.l(d),t=j(d),a&&a.l(d),s=j(d),o&&o.l(d),d.forEach(_),this.h()},h(){E(e,"class","container svelte-1365wnv")},m(i,d){K(i,e,d),n&&n.m(e,null),c(e,t),a&&a.m(e,null),c(e,s),o&&o.m(e,null),r=!0},p(i,[d]){i[4]==="decks"?n?(n.p(i,d),d&16&&O(n,1)):(n=xe(i),n.c(),O(n,1),n.m(e,t)):n&&(fe(),H(n,1,1,()=>{n=null}),he()),i[4]==="edit-deck"&&i[2]?a?(a.p(i,d),d&20&&O(a,1)):(a=et(i),a.c(),O(a,1),a.m(e,s)):a&&(fe(),H(a,1,1,()=>{a=null}),he()),i[4]==="edit-card"&&i[2]&&i[3]?o?(o.p(i,d),d&28&&O(o,1)):(o=tt(i),o.c(),O(o,1),o.m(e,null)):o&&(fe(),H(o,1,1,()=>{o=null}),he())},i(i){r||(O(n),O(a),O(o),r=!0)},o(i){H(n),H(a),H(o),r=!1},d(i){i&&_(e),n&&n.d(),a&&a.d(),o&&o.d()}}}function Bt(l,e,t){let s,r=[],n=null,a=null,o="decks";const i=u=>{t(4,o=u),o==="review"&&(window.location.href=`${_t}/`)};Be(()=>{t(0,s=vt()),t(1,r=s.getDecks())});function d(u){r=u,t(1,r)}const v=u=>{t(2,n=u.detail.deck),i("edit-deck")},f=u=>{const A=u.detail.to;i(A)};function T(u){n=u,t(2,n)}const C=u=>{t(3,a=u.detail.sentence),i("edit-card")},D=u=>{t(3,a=null),t(2,n=null),i("decks")},w=u=>{const A=u.detail.to;i(A)};function $(u){n=u,t(2,n)}function R(u){a=u,t(3,a)}return[s,r,n,a,o,i,d,v,f,T,C,D,w,$,R,u=>{t(3,a=null),i("edit-deck")},u=>{t(3,a=null),i("edit-deck")}]}class Pt extends _e{constructor(e){super(),ge(this,e,Bt,qt,ve,{})}}export{Pt as component};
