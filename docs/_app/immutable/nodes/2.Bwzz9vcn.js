import{S as le,s as x,e as E,t as q,d as I,f as j,h as A,i as m,w as ne,v as S,k as D,l as w,m as U,E as ee,T as Ie,b as P,p as F,j as T,r as ye,U as R,V as re,x as Se,W as J,X as je,Y as Ve,Z as K,_ as Ne,$ as ie}from"../chunks/scheduler.BYqXt0-T.js";import{S as te,i as se,f as ae,t as N,g as Z,a as M,c as z,b as B,d as W,m as X,e as Y,h as Pe}from"../chunks/index.BLJpQBEb.js";import{S as Te,h as Le,s as oe,a as ce,p as $,C as fe,b as Me,c as Ue,d as Oe,e as G}from"../chunks/srs.D4-oNk5N.js";import{b as Re}from"../chunks/paths.DsbW_1TZ.js";const He={id:"placeholder-card",raw:"私（わたし）は学生（がくせい）です",reading:["私","は","学生","で","す"],furigana:["わたし","","がくせい","",""],translation:"I am a student",note:"This is a note and will be shown with the answer.",hint:"This is a hint and will be shown with the question.",srs:{stage:Te.Apprentice1,nextReview:new Date,lastReview:new Date,streak:0,maxStreak:0}},Fe=(l,e)=>{const t=Le(e);if(e==="")return{readingCorrectness:Array.from({length:l.reading.length},()=>!1),answerCorrectness:Array.from({length:e.length},()=>!1),isCorrect:!1};const n=Je(t,l),a=e.split("").map((c,h)=>c===n.expectedAnswer[h]),r=n.expectedAnswer.map((c,h)=>c===e[h]),s=Array.from({length:l.reading.length},()=>!0);n.readingMapping.map((c,h)=>{r[h]||(s[c]=!1)});const i=a.every(c=>c),o=s.every(c=>c),d=e.length===n.expectedAnswer.length;return{readingCorrectness:s,answerCorrectness:a,isCorrect:i&&o&&d}},Je=(l,e)=>{const t=[],n=[];for(let a=0;a<e.reading.length;a++){const r=e.furigana[a],s=e.reading[a];l?s.split("").forEach((i,o)=>{t.push(i),n.push(a)}):(r===""?s:r).split("").forEach((o,d)=>{t.push(o),n.push(a)})}return{expectedAnswer:t,readingMapping:n}};function Ke(l){const e=l-1;return e*e*e+1}function ue(l,{delay:e=0,duration:t=400,easing:n=Ke,x:a=0,y:r=0,opacity:s=0}={}){const i=getComputedStyle(l),o=+i.opacity,d=i.transform==="none"?"":i.transform,c=o*(1-s),[h,p]=le(a),[f,_]=le(r);return{delay:e,duration:t,easing:n,css:(u,g)=>`
			transform: ${d} translate(${(1-u)*h}${p}, ${(1-u)*f}${_});
			opacity: ${o-c*g}`}}function Ze(l){let e,t,n=oe(l[0])+"",a,r,s;return{c(){e=E("div"),t=E("p"),a=q(n),this.h()},l(i){e=I(i,"DIV",{class:!0});var o=j(e);t=I(o,"P",{style:!0});var d=j(t);a=A(d,n),d.forEach(m),o.forEach(m),this.h()},h(){ne(t,"color",ce(l[0])),S(e,"class","popup svelte-78kmxn")},m(i,o){D(i,e,o),w(e,t),w(t,a),s=!0},p(i,[o]){l=i,(!s||o&1)&&n!==(n=oe(l[0])+"")&&U(a,n),(!s||o&1)&&ne(t,"color",ce(l[0]))},i(i){s||(i&&ee(()=>{s&&(r||(r=ae(e,ue,l[1]?{y:50}:{y:-50},!0)),r.run(1))}),s=!0)},o(i){i&&(r||(r=ae(e,ue,l[1]?{y:50}:{y:-50},!1)),r.run(0)),s=!1},d(i){i&&m(e),i&&r&&r.end()}}}function ze(l,e,t){const n=Ie();let{stage:a}=e,{animateUp:r=!1}=e;return setTimeout(()=>{n("hide")},1e3),l.$$set=i=>{"stage"in i&&t(0,a=i.stage),"animateUp"in i&&t(1,r=i.animateUp)},[a,r]}class Be extends te{constructor(e){super(),se(this,e,ze,Ze,x,{stage:0,animateUp:1})}}function de(l){let e,t="No sentences to review",n,a,r="Try adding some sentences to the deck or select a different deck";return{c(){e=E("h1"),e.textContent=t,n=P(),a=E("p"),a.textContent=r,this.h()},l(s){e=I(s,"H1",{class:!0,"data-svelte-h":!0}),R(e)!=="svelte-1bxwpcq"&&(e.textContent=t),n=T(s),a=I(s,"P",{class:!0,"data-svelte-h":!0}),R(a)!=="svelte-eiv2gi"&&(a.textContent=r),this.h()},h(){S(e,"class","svelte-1sqxtjl"),S(a,"class","centered svelte-1sqxtjl")},m(s,i){D(s,e,i),D(s,n,i),D(s,a,i)},d(s){s&&(m(e),m(n),m(a))}}}function he(l){let e,t=l[2].translation+"",n,a,r,s,i=l[2].hint+"",o,d,c,h,p,f,_,u,g,k=l[5]&&_e(l),b=l[4]&&pe(l),C=l[3]&&me(l);return{c(){e=E("h1"),n=q(t),a=P(),r=E("div"),s=E("p"),o=q(i),d=P(),k&&k.c(),c=P(),h=E("div"),p=E("input"),f=P(),b&&b.c(),_=P(),C&&C.c(),u=F(),this.h()},l(v){e=I(v,"H1",{class:!0});var y=j(e);n=A(y,t),y.forEach(m),a=T(v),r=I(v,"DIV",{class:!0});var O=j(r);s=I(O,"P",{});var H=j(s);o=A(H,i),H.forEach(m),O.forEach(m),d=T(v),k&&k.l(v),c=T(v),h=I(v,"DIV",{class:!0});var L=j(h);p=I(L,"INPUT",{type:!0,class:!0}),L.forEach(m),f=T(v),b&&b.l(v),_=T(v),C&&C.l(v),u=F(),this.h()},h(){S(e,"class","svelte-1sqxtjl"),S(r,"class","hint-container svelte-1sqxtjl"),S(p,"type","text"),S(p,"class","svelte-1sqxtjl"),S(h,"class","input-container svelte-1sqxtjl")},m(v,y){D(v,e,y),w(e,n),D(v,a,y),D(v,r,y),w(r,s),w(s,o),D(v,d,y),k&&k.m(v,y),D(v,c,y),D(v,h,y),w(h,p),l[14](p),D(v,f,y),b&&b.m(v,y),D(v,_,y),C&&C.m(v,y),D(v,u,y),g=!0},p(v,y){(!g||y&4)&&t!==(t=v[2].translation+"")&&U(n,t),(!g||y&4)&&i!==(i=v[2].hint+"")&&U(o,i),v[5]?k?(k.p(v,y),y&32&&N(k,1)):(k=_e(v),k.c(),N(k,1),k.m(c.parentNode,c)):k&&(Z(),M(k,1,1,()=>{k=null}),z()),v[4]?b?b.p(v,y):(b=pe(v),b.c(),b.m(_.parentNode,_)):b&&(b.d(1),b=null),v[3]?C?(C.p(v,y),y&8&&N(C,1)):(C=me(v),C.c(),N(C,1),C.m(u.parentNode,u)):C&&(Z(),M(C,1,1,()=>{C=null}),z())},i(v){g||(N(k),N(C),g=!0)},o(v){M(k),M(C),g=!1},d(v){v&&(m(e),m(a),m(r),m(d),m(c),m(h),m(f),m(_),m(u)),k&&k.d(v),l[14](null),b&&b.d(v),C&&C.d(v)}}}function _e(l){let e,t;return e=new Be({props:{stage:l[6],animateUp:l[6]>l[7]}}),e.$on("hide",l[13]),{c(){B(e.$$.fragment)},l(n){W(e.$$.fragment,n)},m(n,a){X(e,n,a),t=!0},p(n,a){const r={};a&64&&(r.stage=n[6]),a&192&&(r.animateUp=n[6]>n[7]),e.$set(r)},i(n){t||(N(e.$$.fragment,n),t=!0)},o(n){M(e.$$.fragment,n),t=!1},d(n){Y(e,n)}}}function pe(l){let e,t;return{c(){e=E("div"),t=q(l[4]),this.h()},l(n){e=I(n,"DIV",{class:!0});var a=j(e);t=A(a,l[4]),a.forEach(m),this.h()},h(){S(e,"class","notification svelte-1sqxtjl")},m(n,a){D(n,e,a),w(e,t)},p(n,a){a&16&&U(t,n[4])},d(n){n&&m(e)}}}function me(l){let e,t,n,a,r,s,i,o,d,c=l[8]?"Correct!":"Incorrect",h,p,f;t=new fe({props:{readings:l[1],furigana:[],colors:l[10]}}),r=new fe({props:{readings:l[2].reading,furigana:l[2].furigana,colors:l[9]}});let _=l[2].note&&ve(l);return{c(){e=E("div"),B(t.$$.fragment),n=P(),a=E("div"),B(r.$$.fragment),s=P(),_&&_.c(),i=P(),o=E("div"),d=E("h2"),h=q(c),this.h()},l(u){e=I(u,"DIV",{class:!0});var g=j(e);W(t.$$.fragment,g),g.forEach(m),n=T(u),a=I(u,"DIV",{class:!0});var k=j(a);W(r.$$.fragment,k),k.forEach(m),s=T(u),_&&_.l(u),i=T(u),o=I(u,"DIV",{class:!0});var b=j(o);d=I(b,"H2",{class:!0});var C=j(d);h=A(C,c),C.forEach(m),b.forEach(m),this.h()},h(){S(e,"class","sentence-container svelte-1sqxtjl"),S(a,"class","sentence-container svelte-1sqxtjl"),S(d,"class",p=re(l[8]?"correct":"incorrect")+" svelte-1sqxtjl"),S(o,"class","result-container svelte-1sqxtjl")},m(u,g){D(u,e,g),X(t,e,null),D(u,n,g),D(u,a,g),X(r,a,null),D(u,s,g),_&&_.m(u,g),D(u,i,g),D(u,o,g),w(o,d),w(d,h),f=!0},p(u,g){const k={};g&2&&(k.readings=u[1]),g&1024&&(k.colors=u[10]),t.$set(k);const b={};g&4&&(b.readings=u[2].reading),g&4&&(b.furigana=u[2].furigana),g&512&&(b.colors=u[9]),r.$set(b),u[2].note?_?_.p(u,g):(_=ve(u),_.c(),_.m(i.parentNode,i)):_&&(_.d(1),_=null),(!f||g&256)&&c!==(c=u[8]?"Correct!":"Incorrect")&&U(h,c),(!f||g&256&&p!==(p=re(u[8]?"correct":"incorrect")+" svelte-1sqxtjl"))&&S(d,"class",p)},i(u){f||(N(t.$$.fragment,u),N(r.$$.fragment,u),f=!0)},o(u){M(t.$$.fragment,u),M(r.$$.fragment,u),f=!1},d(u){u&&(m(e),m(n),m(a),m(s),m(i),m(o)),Y(t),Y(r),_&&_.d(u)}}}function ve(l){let e,t,n=l[2].note+"",a;return{c(){e=E("div"),t=E("p"),a=q(n),this.h()},l(r){e=I(r,"DIV",{class:!0});var s=j(e);t=I(s,"P",{});var i=j(t);a=A(i,n),i.forEach(m),s.forEach(m),this.h()},h(){S(e,"class","note-container svelte-1sqxtjl")},m(r,s){D(r,e,s),w(e,t),w(t,a)},p(r,s){s&4&&n!==(n=r[2].note+"")&&U(a,n)},d(r){r&&m(e)}}}function We(l){let e,t,n,a=l[2]===null&&de(),r=l[2]&&he(l);return{c(){a&&a.c(),e=P(),r&&r.c(),t=F()},l(s){a&&a.l(s),e=T(s),r&&r.l(s),t=F()},m(s,i){a&&a.m(s,i),D(s,e,i),r&&r.m(s,i),D(s,t,i),n=!0},p(s,[i]){s[2]===null?a||(a=de(),a.c(),a.m(e.parentNode,e)):a&&(a.d(1),a=null),s[2]?r?(r.p(s,i),i&4&&N(r,1)):(r=he(s),r.c(),N(r,1),r.m(t.parentNode,t)):r&&(Z(),M(r,1,1,()=>{r=null}),z())},i(s){n||(N(r),n=!0)},o(s){M(r),n=!1},d(s){s&&(m(e),m(t)),a&&a.d(s),r&&r.d(s)}}}function Xe(l,e,t){let n,a,r,s,i,{selectedDeck:o=null}=e;const d=Ie();let c,h="",p=!1,f=!1,_="",u=!1,g,k,b=!1;const C=()=>{if(n.length>0){if(n=o?$(o):[],console.log("Number of sentences: "+n.length),n.length===0){t(2,L=null);return}t(2,L=n[Math.floor(Math.random()*n.length)])}O()},v=()=>{t(1,h=""),t(0,c.value="",c),t(3,p=!1)},y=()=>{t(3,p=!0);const V=L==null?void 0:L.srs;if(V&&!b){const Q=Me(V,i);t(6,g=Q.stage),t(7,k=V.stage),t(5,u=!0),d("srs",{sentence:L,srs:Q})}},O=()=>{c&&c.focus()},H=V=>{if(V===""){f=!0,t(4,_="Input cannot be empty!");return}f=/[a-zA-Z0-9]/.test(V),t(4,_=f?"Invalid characters in input!":"")};let L=null;ye(()=>{C(),window.addEventListener("keydown",V=>{if(V.key==="Enter"){if(H(h),f)return;o&&L&&p?(v(),C()):y()}})});const qe=()=>t(5,u=!1);function Ae(V){Se[V?"unshift":"push"](()=>{c=V,t(0,c)})}return l.$$set=V=>{"selectedDeck"in V&&t(11,o=V.selectedDeck)},l.$$.update=()=>{l.$$.dirty&2048&&(n=o?$(o):[]),l.$$.dirty&2048&&o&&C(),l.$$.dirty&4&&L&&(b=!1),l.$$.dirty&1&&c&&(t(0,c.value="",c),c&&Ue(c),c.addEventListener("input",V=>{t(1,h=Oe(V.target.value))}),O()),l.$$.dirty&6&&t(12,a=L&&Fe(L,h)),l.$$.dirty&4096&&t(10,r=a&&a.answerCorrectness.map(V=>V?"#94f77e":"#f25f44")),l.$$.dirty&4096&&t(9,s=a&&a.readingCorrectness.map(V=>V?"#94f77e":"#f25f44")),l.$$.dirty&4096&&t(8,i=a?a.isCorrect:!1)},[c,h,L,p,_,u,g,k,i,s,r,o,a,qe,Ae]}class Ye extends te{constructor(e){super(),se(this,e,Xe,We,x,{selectedDeck:11})}}function ge(l,e,t){const n=l.slice();return n[12]=e[t],n[14]=t,n}function ke(l,e,t){const n=l.slice();return n[12]=e[t],n[14]=t,n}function we(l){let e,t,n="Choose a deck:",a,r,s,i,o=`<a href="${`${Re}/decks`}">Manage Decks</a>`,d,c,h=G(l[0]),p=[];for(let f=0;f<h.length;f+=1)p[f]=be(ke(l,h,f));return{c(){e=E("form"),t=E("label"),t.textContent=n,a=P(),r=E("select");for(let f=0;f<p.length;f+=1)p[f].c();s=P(),i=E("p"),i.innerHTML=o,this.h()},l(f){e=I(f,"FORM",{});var _=j(e);t=I(_,"LABEL",{for:!0,"data-svelte-h":!0}),R(t)!=="svelte-smnxxd"&&(t.textContent=n),a=T(_),r=I(_,"SELECT",{name:!0,id:!0});var u=j(r);for(let g=0;g<p.length;g+=1)p[g].l(u);u.forEach(m),_.forEach(m),s=T(f),i=I(f,"P",{"data-svelte-h":!0}),R(i)!=="svelte-19nwu32"&&(i.innerHTML=o),this.h()},h(){S(t,"for","decks"),S(r,"name","decks"),S(r,"id","decks"),l[1]===void 0&&ee(()=>l[7].call(r))},m(f,_){D(f,e,_),w(e,t),w(e,a),w(e,r);for(let u=0;u<p.length;u+=1)p[u]&&p[u].m(r,null);J(r,l[1],!0),D(f,s,_),D(f,i,_),d||(c=je(r,"change",l[7]),d=!0)},p(f,_){if(_&33){h=G(f[0]);let u;for(u=0;u<h.length;u+=1){const g=ke(f,h,u);p[u]?p[u].p(g,_):(p[u]=be(g),p[u].c(),p[u].m(r,null))}for(;u<p.length;u+=1)p[u].d(1);p.length=h.length}_&3&&J(r,f[1])},d(f){f&&(m(e),m(s),m(i)),Ve(p,f),d=!1,c()}}}function be(l){let e,t=l[12].name+"",n,a,r=l[5][l[14]]+"",s,i,o;return{c(){e=E("option"),n=q(t),a=q(" ("),s=q(r),i=q(")"),this.h()},l(d){e=I(d,"OPTION",{});var c=j(e);n=A(c,t),a=A(c," ("),s=A(c,r),i=A(c,")"),c.forEach(m),this.h()},h(){e.__value=o=l[12],K(e,e.__value)},m(d,c){D(d,e,c),w(e,n),w(e,a),w(e,s),w(e,i)},p(d,c){c&1&&t!==(t=d[12].name+"")&&U(n,t),c&32&&r!==(r=d[5][d[14]]+"")&&U(s,r),c&1&&o!==(o=d[12])&&(e.__value=o,K(e,e.__value))},d(d){d&&m(e)}}}function Ce(l){let e,t,n="Choose a deck",a,r,s,i,o,d=G(l[0]),c=[];for(let h=0;h<d.length;h+=1)c[h]=De(ge(l,d,h));return{c(){e=E("div"),t=E("h1"),t.textContent=n,a=P(),r=E("form"),s=E("select");for(let h=0;h<c.length;h+=1)c[h].c();this.h()},l(h){e=I(h,"DIV",{class:!0});var p=j(e);t=I(p,"H1",{class:!0,"data-svelte-h":!0}),R(t)!=="svelte-1mswgjr"&&(t.textContent=n),a=T(p),r=I(p,"FORM",{});var f=j(r);s=I(f,"SELECT",{name:!0,id:!0,class:!0});var _=j(s);for(let u=0;u<c.length;u+=1)c[u].l(_);_.forEach(m),f.forEach(m),p.forEach(m),this.h()},h(){S(t,"class","svelte-123dyy7"),S(s,"name","decks"),S(s,"id","decks"),S(s,"class","svelte-123dyy7"),l[1]===void 0&&ee(()=>l[8].call(s)),S(e,"class","pick-decks-container svelte-123dyy7")},m(h,p){D(h,e,p),w(e,t),w(e,a),w(e,r),w(r,s);for(let f=0;f<c.length;f+=1)c[f]&&c[f].m(s,null);J(s,l[1],!0),i||(o=je(s,"change",l[8]),i=!0)},p(h,p){if(p&49){d=G(h[0]);let f;for(f=0;f<d.length;f+=1){const _=ge(h,d,f);c[f]?c[f].p(_,p):(c[f]=De(_),c[f].c(),c[f].m(s,null))}for(;f<c.length;f+=1)c[f].d(1);c.length=d.length}p&3&&J(s,h[1])},d(h){h&&m(e),Ve(c,h),i=!1,o()}}}function De(l){let e,t=l[12].name+"",n,a,r=l[5][l[14]]+"",s,i,o=l[4][l[14]]+"",d,c,h;return{c(){e=E("option"),n=q(t),a=q("  ("),s=q(r),i=q("/"),d=q(o),c=q(")"),this.h()},l(p){e=I(p,"OPTION",{});var f=j(e);n=A(f,t),a=A(f,"  ("),s=A(f,r),i=A(f,"/"),d=A(f,o),c=A(f,")"),f.forEach(m),this.h()},h(){e.__value=h=l[12],K(e,e.__value)},m(p,f){D(p,e,f),w(e,n),w(e,a),w(e,s),w(e,i),w(e,d),w(e,c)},p(p,f){f&1&&t!==(t=p[12].name+"")&&U(n,t),f&32&&r!==(r=p[5][p[14]]+"")&&U(s,r),f&16&&o!==(o=p[4][p[14]]+"")&&U(d,o),f&1&&h!==(h=p[12])&&(e.__value=h,K(e,e.__value))},d(p){p&&m(e)}}}function Ee(l){let e,t,n;function a(s){l[9](s)}let r={};return l[1]!==void 0&&(r.selectedDeck=l[1]),e=new Ye({props:r}),Se.push(()=>Pe(e,"selectedDeck",a)),e.$on("srs",l[10]),{c(){B(e.$$.fragment)},l(s){W(e.$$.fragment,s)},m(s,i){X(e,s,i),n=!0},p(s,i){const o={};!t&&i&2&&(t=!0,o.selectedDeck=s[1],Ne(()=>t=!1)),e.$set(o)},i(s){n||(N(e.$$.fragment,s),n=!0)},o(s){M(e.$$.fragment,s),n=!1},d(s){Y(e,s)}}}function Ge(l){let e,t,n,a,r,s=l[2]&&we(l),i=l[3]&&Ce(l),o=l[2]&&Ee(l);return{c(){e=E("div"),s&&s.c(),t=P(),n=E("div"),i&&i.c(),a=P(),o&&o.c(),this.h()},l(d){e=I(d,"DIV",{class:!0});var c=j(e);s&&s.l(c),t=T(c),n=I(c,"DIV",{class:!0});var h=j(n);i&&i.l(h),a=T(h),o&&o.l(h),h.forEach(m),c.forEach(m),this.h()},h(){S(n,"class","container svelte-123dyy7"),S(e,"class","page")},m(d,c){D(d,e,c),s&&s.m(e,null),w(e,t),w(e,n),i&&i.m(n,null),w(n,a),o&&o.m(n,null),r=!0},p(d,[c]){d[2]?s?s.p(d,c):(s=we(d),s.c(),s.m(e,t)):s&&(s.d(1),s=null),d[3]?i?i.p(d,c):(i=Ce(d),i.c(),i.m(n,a)):i&&(i.d(1),i=null),d[2]?o?(o.p(d,c),c&4&&N(o,1)):(o=Ee(d),o.c(),N(o,1),o.m(n,null)):o&&(Z(),M(o,1,1,()=>{o=null}),z())},i(d){r||(N(o),r=!0)},o(d){M(o),r=!1},d(d){d&&m(e),s&&s.d(),i&&i.d(),o&&o.d()}}}function Qe(l,e,t){let n,a,r,s,i=[],o;const d=(_,u)=>{const g=o,k=_,b=i.findIndex(v=>v===g),C=g.sentences.findIndex(v=>v===k);b!==-1&&C!==-1&&(g.sentences[C]={...k,srs:u},console.log("Saving deck"),t(0,i[b]=g,i)),localStorage.setItem("decks",JSON.stringify(i))};ye(()=>{const _=localStorage.getItem("decks");_&&t(0,i=JSON.parse(_)),(!_||i.length==0)&&t(0,i=[{id:"placeholder",name:"Default Deck",description:"This is a default deck",sentences:[He]}])});function c(){o=ie(this),t(1,o),t(0,i)}function h(){o=ie(this),t(1,o),t(0,i)}function p(_){o=_,t(1,o)}const f=_=>{d(_.detail.sentence,_.detail.srs)};return l.$$.update=()=>{l.$$.dirty&1&&t(5,n=i.map(_=>$(_).length)),l.$$.dirty&1&&t(4,a=i.map(_=>_.sentences.length)),l.$$.dirty&1&&i.length,l.$$.dirty&3&&t(3,r=i.length>0&&o===null),l.$$.dirty&2&&t(2,s=o!==null)},[i,o,s,r,a,n,d,c,h,p,f]}class st extends te{constructor(e){super(),se(this,e,Qe,Ge,x,{})}}export{st as component};
