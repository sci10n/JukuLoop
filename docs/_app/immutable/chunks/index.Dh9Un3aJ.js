function dt(e){return(e==null?void 0:e.length)!==void 0?e:Array.from(e)}function O(e){return e===null?"null":e!==Object(e)?typeof e:{}.toString.call(e).slice(8,-1).toLowerCase()}function A(e){return O(e)!=="string"?!0:!e.length}function h(e="",t,o){if(A(e))return!1;const n=e.charCodeAt(0);return t<=n&&n<=o}const y={HIRAGANA:"toHiragana",KATAKANA:"toKatakana"},v={HEPBURN:"hepburn"},q={useObsoleteKana:!1,passRomaji:!1,convertLongVowelMark:!0,upcaseKatakana:!1,IMEMode:!1,romanization:v.HEPBURN},V=65,X=90,F=65345,Q=65370,ee=65313,te=65338,x=12353,ne=12438,m=12449,oe=12540,se=12540,ie=12539,re=[65296,65305],ce=[ee,te],ae=[F,Q],fe=[65281,65295],ue=[65306,65311],le=[65339,65343],Ae=[65371,65376],Ee=[65504,65518],Oe=[12352,12447],de=[12448,12543],he=[65382,65439],pe=[12539,12540],P=[65377,65381],Ne=[12288,12351],Se=[19968,40959],ge=[13312,19903],Te=[Oe,de,P,he],Ke=[Ne,P,pe,fe,ue,le,Ae,Ee],je=[...Te,...Ke,ce,ae,re,Se,ge];function Ce(e=""){return je.some(([t,o])=>h(e,t,o))}function p(e="",t){const o=O(t)==="regexp";return A(e)?!1:[...e].every(n=>{const s=Ce(n);return o?s||t.test(n):s})}var b=Number.isNaN||function(t){return typeof t=="number"&&t!==t};function ye(e,t){return!!(e===t||b(e)&&b(t))}function be(e,t){if(e.length!==t.length)return!1;for(var o=0;o<e.length;o++)if(!ye(e[o],t[o]))return!1;return!0}function k(e,t){t===void 0&&(t=be);var o=null;function n(){for(var s=[],i=0;i<arguments.length;i++)s[i]=arguments[i];if(o&&o.lastThis===this&&t(s,o.lastArgs))return o.lastResult;var r=e.apply(this,s);return o={lastResult:r,lastArgs:s,lastThis:this},r}return n.clear=function(){o=null},n}var I=Object.prototype.hasOwnProperty;function U(e,t,o){for(o of e.keys())if(E(o,t))return o}function E(e,t){var o,n,s;if(e===t)return!0;if(e&&t&&(o=e.constructor)===t.constructor){if(o===Date)return e.getTime()===t.getTime();if(o===RegExp)return e.toString()===t.toString();if(o===Array){if((n=e.length)===t.length)for(;n--&&E(e[n],t[n]););return n===-1}if(o===Set){if(e.size!==t.size)return!1;for(n of e)if(s=n,s&&typeof s=="object"&&(s=U(t,s),!s)||!t.has(s))return!1;return!0}if(o===Map){if(e.size!==t.size)return!1;for(n of e)if(s=n[0],s&&typeof s=="object"&&(s=U(t,s),!s)||!E(n[1],t.get(s)))return!1;return!0}if(o===ArrayBuffer)e=new Uint8Array(e),t=new Uint8Array(t);else if(o===DataView){if((n=e.byteLength)===t.byteLength)for(;n--&&e.getInt8(n)===t.getInt8(n););return n===-1}if(ArrayBuffer.isView(e)){if((n=e.byteLength)===t.byteLength)for(;n--&&e[n]===t[n];);return n===-1}if(!o||typeof e=="object"){n=0;for(o in e)if(I.call(e,o)&&++n&&!I.call(t,o)||!(o in t)||!E(e[o],t[o]))return!1;return Object.keys(t).length===n}}return e!==e&&t!==t}const J=(e={})=>Object.assign({},q,e);function Ie(e,t,o){const n=t;function s(c,a){if(c[a]!==void 0)return Object.assign({"":c[""]+a},c[a])}function i(c,a){const f=c.charAt(0);return r(Object.assign({"":f},n[f]),c.slice(1),a,a+1)}function r(c,a,f,u){if(!a)return o||Object.keys(c).length===1?c[""]?[[f,u,c[""]]]:[]:[[f,u,null]];if(Object.keys(c).length===1)return[[f,u,c[""]]].concat(i(a,u));const l=s(c,a.charAt(0));return l===void 0?[[f,u,c[""]]].concat(i(a,u)):r(l,a.slice(1),f,u+1)}return i(e,0)}function K(e){return Object.entries(e).reduce((t,[o,n])=>{const s=O(n)==="string";return t[o]=s?{"":n}:K(n),t},{})}function z(e,t){return t.split("").reduce((o,n)=>(o[n]===void 0&&(o[n]={}),o[n]),e)}function H(e={}){const t={};return O(e)==="object"&&Object.entries(e).forEach(([o,n])=>{let s=t;o.split("").forEach(i=>{s[i]===void 0&&(s[i]={}),s=s[i]}),s[""]=n}),function(n){const s=JSON.parse(JSON.stringify(n));function i(r,c){return r===void 0||O(r)==="string"?c:Object.entries(c).reduce((a,[f,u])=>(a[f]=i(r[f],u),a),r)}return i(s,t)}}function D(e,t){return t?O(t)==="function"?t(e):H(t)(e):e}const Ue={a:"あ",i:"い",u:"う",e:"え",o:"お",k:{a:"か",i:"き",u:"く",e:"け",o:"こ"},s:{a:"さ",i:"し",u:"す",e:"せ",o:"そ"},t:{a:"た",i:"ち",u:"つ",e:"て",o:"と"},n:{a:"な",i:"に",u:"ぬ",e:"ね",o:"の"},h:{a:"は",i:"ひ",u:"ふ",e:"へ",o:"ほ"},m:{a:"ま",i:"み",u:"む",e:"め",o:"も"},y:{a:"や",u:"ゆ",o:"よ"},r:{a:"ら",i:"り",u:"る",e:"れ",o:"ろ"},w:{a:"わ",i:"ゐ",e:"ゑ",o:"を"},g:{a:"が",i:"ぎ",u:"ぐ",e:"げ",o:"ご"},z:{a:"ざ",i:"じ",u:"ず",e:"ぜ",o:"ぞ"},d:{a:"だ",i:"ぢ",u:"づ",e:"で",o:"ど"},b:{a:"ば",i:"び",u:"ぶ",e:"べ",o:"ぼ"},p:{a:"ぱ",i:"ぴ",u:"ぷ",e:"ぺ",o:"ぽ"},v:{a:"ゔぁ",i:"ゔぃ",u:"ゔ",e:"ゔぇ",o:"ゔぉ"}},Le={".":"。",",":"、",":":"：","/":"・","!":"！","?":"？","~":"〜","-":"ー","‘":"「","’":"」","“":"『","”":"』","[":"［","]":"］","(":"（",")":"）","{":"｛","}":"｝"},L={k:"き",s:"し",t:"ち",n:"に",h:"ひ",m:"み",r:"り",g:"ぎ",z:"じ",d:"ぢ",b:"び",p:"ぴ",v:"ゔ",q:"く",f:"ふ"},B={ya:"ゃ",yi:"ぃ",yu:"ゅ",ye:"ぇ",yo:"ょ"},$={a:"ぁ",i:"ぃ",u:"ぅ",e:"ぇ",o:"ぉ"},M={sh:"sy",ch:"ty",cy:"ty",chy:"ty",shy:"sy",j:"zy",jy:"zy",shi:"si",chi:"ti",tsu:"tu",ji:"zi",fu:"hu"},Me=Object.assign({tu:"っ",wa:"ゎ",ka:"ヵ",ke:"ヶ"},$,B),_e={yi:"い",wu:"う",ye:"いぇ",wi:"うぃ",we:"うぇ",kwa:"くぁ",whu:"う",tha:"てゃ",thu:"てゅ",tho:"てょ",dha:"でゃ",dhu:"でゅ",dho:"でょ"},we={wh:"う",kw:"く",qw:"く",q:"く",gw:"ぐ",sw:"す",ts:"つ",th:"て",tw:"と",dh:"で",dw:"ど",fw:"ふ",f:"ふ"};function Re(){const e=K(Ue),t=s=>z(e,s);Object.entries(L).forEach(([s,i])=>{Object.entries(B).forEach(([r,c])=>{t(s+r)[""]=i+c})}),Object.entries(Le).forEach(([s,i])=>{t(s)[""]=i}),Object.entries(we).forEach(([s,i])=>{Object.entries($).forEach(([r,c])=>{const a=t(s+r);a[""]=i+c})}),["n","n'","xn"].forEach(s=>{t(s)[""]="ん"}),e.c=JSON.parse(JSON.stringify(e.k)),Object.entries(M).forEach(([s,i])=>{const r=s.slice(0,s.length-1),c=s.charAt(s.length-1),a=t(r);a[c]=JSON.parse(JSON.stringify(t(i)))});function o(s){return[...Object.entries(M),["c","k"]].reduce((i,[r,c])=>s.startsWith(c)?i.concat(s.replace(c,r)):i,[])}Object.entries(Me).forEach(([s,i])=>{const r=l=>l.charAt(l.length-1),c=l=>l.slice(0,l.length-1),a=`x${s}`,f=t(a);f[""]=i;const u=t(`l${c(s)}`);u[r(s)]=f,o(s).forEach(l=>{["l","x"].forEach(C=>{const Y=t(C+c(l));Y[r(l)]=t(C+s)})})}),Object.entries(_e).forEach(([s,i])=>{t(s)[""]=i});function n(s){return Object.entries(s).reduce((i,[r,c])=>(r?i[r]=n(c):i[r]=`っ${c}`,i),{})}return[...Object.keys(L),"c","y","w","j"].forEach(s=>{const i=e[s];i[s]=n(i)}),delete e.n.n,Object.freeze(JSON.parse(JSON.stringify(e)))}let N=null;function ve(){return N==null&&(N=Re()),N}const xe=H({wi:"ゐ",we:"ゑ"});function me(e){const t=JSON.parse(JSON.stringify(e));return t.n.n={"":"ん"},t.n[" "]={"":"ん"},t}function Pe(e=""){return A(e)?!1:h(e,V,X)}function Z(e=""){return A(e)?!1:e.charCodeAt(0)===se}function ke(e=""){return A(e)?!1:e.charCodeAt(0)===ie}function G(e=""){return A(e)?!1:Z(e)?!0:h(e,x,ne)}function Je(e=""){const t=[];return e.split("").forEach(o=>{if(Z(o)||ke(o))t.push(o);else if(G(o)){const n=o.charCodeAt(0)+(m-x),s=String.fromCharCode(n);t.push(s)}else t.push(o)}),t.join("")}const j=k((e,t,o)=>{let n=ve();return n=e?me(n):n,n=t?xe(n):n,o&&(n=D(n,o)),n},E);function ze(e="",t={},o){let n;return o?n=t:(n=J(t),o=j(n.IMEMode,n.useObsoleteKana,n.customKanaMapping)),He(e,n,o).map(s=>{const[i,r,c]=s;if(c===null)return e.slice(i);const a=n.IMEMode===y.HIRAGANA,f=n.IMEMode===y.KATAKANA||[...e.slice(i,r)].every(Pe);return a||!f?c:Je(c)}).join("")}function He(e="",t={},o){const{IMEMode:n,useObsoleteKana:s,customKanaMapping:i}=t;return o||(o=j(n,s,i)),Ie(e.toLowerCase(),o,!n)}let _=[];function De(e){let t;const o=Object.assign({},J(e),{IMEMode:e.IMEMode||!0}),n=j(o.IMEMode,o.useObsoleteKana,o.customKanaMapping),s=[...Object.keys(n),...Object.keys(n).map(i=>i.toUpperCase())];return function({target:r}){r.value!==t&&r.dataset.ignoreComposition!=="true"&&Be(r,o,n,s)}}function Be(e,t,o,n,s){const[i,r,c]=Ze(e.value,e.selectionEnd,n),a=ze(r,t,o);if(r!==a){const u=i.length+a.length,l=i+a+c;e.value=l,c.length?setTimeout(()=>e.setSelectionRange(u,u),1):e.setSelectionRange(u,u)}else e.value}function S({type:e,target:t,data:o}){/Mac/.test(window.navigator&&window.navigator.platform)&&(e==="compositionupdate"&&p(o)&&(t.dataset.ignoreComposition="true"),e==="compositionend"&&(t.dataset.ignoreComposition="false"))}function $e(e,t,o){_=_.concat({id:e,inputHandler:t,compositionHandler:o})}function Ze(e="",t=0,o=[]){let n,s,i;return t===0&&o.includes(e[0])?[n,s,i]=Ge(e,o):t>0?[n,s,i]=We(e,t):([n,s]=d(e,r=>!o.includes(r)),[s,i]=d(s,r=>!p(r))),[n,s,i]}function Ge(e,t){return["",...d(e,o=>t.includes(o)||!p(o,/[0-9]/))]}function We(e="",t=0){const[o,n]=d([...e.slice(0,t)].reverse(),s=>!p(s));return[n.reverse().join(""),o.split("").reverse().join(""),e.slice(t)]}function d(e={},t=o=>!!o){const o=[],{length:n}=e;let s=0;for(;s<n&&t(e[s],s);)o.push(e[s]),s+=1;return[o.join(""),e.slice(s)]}const Ye=({target:{value:e,selectionStart:t,selectionEnd:o}})=>console.log("input:",{value:e,selectionStart:t,selectionEnd:o}),qe=()=>console.log("compositionstart"),Ve=({target:{value:e,selectionStart:t,selectionEnd:o},data:n})=>console.log("compositionupdate",{data:n,value:e,selectionStart:t,selectionEnd:o}),Xe=()=>console.log("compositionend"),Fe={input:Ye,compositionstart:qe,compositionupdate:Ve,compositionend:Xe},Qe=e=>{Object.entries(Fe).forEach(([t,o])=>e.addEventListener(t,o))},et=["TEXTAREA","INPUT"];let w=0;const tt=()=>(w+=1,`${Date.now()}${w}`);function ht(e={},t={},o=!1){if(!et.includes(e.nodeName))throw new Error(`Element provided to Wanakana bind() was not a valid input or textarea element.
 Received: (${JSON.stringify(e)})`);if(e.hasAttribute("data-wanakana-id"))return;const n=De(t),s=tt(),i=[{name:"data-wanakana-id",value:s},{name:"lang",value:"ja"},{name:"autoCapitalize",value:"none"},{name:"autoCorrect",value:"off"},{name:"autoComplete",value:"off"},{name:"spellCheck",value:"false"}],r={};i.forEach(c=>{r[c.name]=e.getAttribute(c.name),e.setAttribute(c.name,c.value)}),e.dataset.previousAttributes=JSON.stringify(r),e.addEventListener("input",n),e.addEventListener("compositionupdate",S),e.addEventListener("compositionend",S),$e(s,n,S),o===!0&&Qe(e)}function nt(e=""){return h(e,m,oe)}function ot(e=""){return A(e)?!1:G(e)||nt(e)}function pt(e=""){return A(e)?!1:[...e].every(ot)}let g=null;const st={あ:"a",い:"i",う:"u",え:"e",お:"o",か:"ka",き:"ki",く:"ku",け:"ke",こ:"ko",さ:"sa",し:"shi",す:"su",せ:"se",そ:"so",た:"ta",ち:"chi",つ:"tsu",て:"te",と:"to",な:"na",に:"ni",ぬ:"nu",ね:"ne",の:"no",は:"ha",ひ:"hi",ふ:"fu",へ:"he",ほ:"ho",ま:"ma",み:"mi",む:"mu",め:"me",も:"mo",ら:"ra",り:"ri",る:"ru",れ:"re",ろ:"ro",や:"ya",ゆ:"yu",よ:"yo",わ:"wa",ゐ:"wi",ゑ:"we",を:"wo",ん:"n",が:"ga",ぎ:"gi",ぐ:"gu",げ:"ge",ご:"go",ざ:"za",じ:"ji",ず:"zu",ぜ:"ze",ぞ:"zo",だ:"da",ぢ:"ji",づ:"zu",で:"de",ど:"do",ば:"ba",び:"bi",ぶ:"bu",べ:"be",ぼ:"bo",ぱ:"pa",ぴ:"pi",ぷ:"pu",ぺ:"pe",ぽ:"po",ゔぁ:"va",ゔぃ:"vi",ゔ:"vu",ゔぇ:"ve",ゔぉ:"vo"},it={"。":".","、":",","：":":","・":"/","！":"!","？":"?","〜":"~",ー:"-","「":"‘","」":"’","『":"“","』":"”","［":"[","］":"]","（":"(","）":")","｛":"{","｝":"}","　":" "},rt=["あ","い","う","え","お","や","ゆ","よ"],T={ゃ:"ya",ゅ:"yu",ょ:"yo"},ct={ぃ:"yi",ぇ:"ye"},at={ぁ:"a",ぃ:"i",ぅ:"u",ぇ:"e",ぉ:"o"},ft=["き","に","ひ","み","り","ぎ","び","ぴ","ゔ","く","ふ"],ut={し:"sh",ち:"ch",じ:"j",ぢ:"j"},lt={っ:"",ゃ:"ya",ゅ:"yu",ょ:"yo",ぁ:"a",ぃ:"i",ぅ:"u",ぇ:"e",ぉ:"o"},R={b:"b",c:"t",d:"d",f:"f",g:"g",h:"h",j:"j",k:"k",m:"m",p:"p",q:"q",r:"r",s:"s",t:"t",v:"v",w:"w",x:"x",z:"z"};function At(){return g==null&&(g=Ot()),g}function Et(e){switch(e){case v.HEPBURN:return At();default:return{}}}function Ot(){const e=K(st),t=n=>z(e,n),o=(n,s)=>{t(n)[""]=s};return Object.entries(it).forEach(([n,s])=>{t(n)[""]=s}),[...Object.entries(T),...Object.entries(at)].forEach(([n,s])=>{o(n,s)}),ft.forEach(n=>{const s=t(n)[""][0];Object.entries(T).forEach(([i,r])=>{o(n+i,s+r)}),Object.entries(ct).forEach(([i,r])=>{o(n+i,s+r)})}),Object.entries(ut).forEach(([n,s])=>{Object.entries(T).forEach(([i,r])=>{o(n+i,s+r[1])}),o(`${n}ぃ`,`${s}yi`),o(`${n}ぇ`,`${s}e`)}),e.っ=W(e),Object.entries(lt).forEach(([n,s])=>{o(n,s)}),rt.forEach(n=>{o(`ん${n}`,`n'${t(n)[""]}`)}),Object.freeze(JSON.parse(JSON.stringify(e)))}function W(e){return Object.entries(e).reduce((t,[o,n])=>{if(o)t[o]=W(n);else{const s=n.charAt(0);t[o]=Object.keys(R).includes(s)?R[s]+n:n}return t},{})}k((e,t)=>{let o=Et(e);return t&&(o=D(o,t)),o},E);export{ht as b,dt as e,pt as i,ze as t};
